<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScriptæ§åˆ¶ - SVGå­¦ä¹ ç¤ºä¾‹</title>
    <link rel="stylesheet" href="../../common/styles.css">
    <link rel="stylesheet" href="../../common/demo.css">
    <style>
        .demo-svg {
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fafafa;
            overflow: visible;
        }
        
        .interactive-svg {
            cursor: pointer;
        }
        
        .draggable {
            cursor: move;
        }
        
        .drawing-canvas {
            background: #f8f8f8;
            border: 2px dashed #ccc;
        }
    </style>
</head>
<body class="demo-page">
    <div class="demo-header">
        <div class="container">
            <nav class="breadcrumb">
                <ol class="breadcrumb-list">
                    <li class="breadcrumb-item"><a href="../../index.html">ç¤ºä¾‹é¦–é¡µ</a></li>
                    <li class="breadcrumb-item"><a href="../index.html">åŠ¨ç”»ä¸äº¤äº’</a></li>
                    <li class="breadcrumb-item active">JavaScriptæ§åˆ¶</li>
                </ol>
            </nav>
            <h1 class="demo-title">JavaScriptæ§åˆ¶</h1>
            <p class="demo-subtitle">ä½¿ç”¨JavaScriptæ“ä½œSVGå…ƒç´ ï¼Œåˆ›å»ºåŠ¨æ€äº¤äº’çš„å›¾å½¢åº”ç”¨</p>
        </div>
    </div>

    <div class="container">
        <div class="demo-main">
            <div class="demo-content">
                <!-- åŸºç¡€DOMæ“ä½œ -->
                <div class="card">
                    <h2>ğŸ¯ åŸºç¡€DOMæ“ä½œ</h2>
                    <p>ä½¿ç”¨JavaScriptè·å–å’Œæ“ä½œSVGå…ƒç´ çš„å±æ€§å’Œæ ·å¼ã€‚</p>
                    
                    <div class="grid grid-3">
                        <div>
                            <h3>å±æ€§æ“ä½œ</h3>
                            <div class="svg-example">
                                <svg width="150" height="100" viewBox="0 0 150 100" class="demo-svg">
                                    <circle id="circle1" cx="75" cy="50" r="20" fill="#2196F3"/>
                                </svg>
                                <div class="control-group">
                                    <button onclick="changeCircleSize()" class="btn btn-sm">æ”¹å˜å¤§å°</button>
                                    <button onclick="changeCircleColor()" class="btn btn-sm">æ”¹å˜é¢œè‰²</button>
                                </div>
                            </div>
                            <div class="code-editor">
                                <div class="code-content">element.setAttribute('r', '30');</div>
                            </div>
                        </div>
                        
                        <div>
                            <h3>æ ·å¼æ“ä½œ</h3>
                            <div class="svg-example">
                                <svg width="150" height="100" viewBox="0 0 150 100" class="demo-svg">
                                    <rect id="rect1" x="50" y="30" width="50" height="30" fill="#4CAF50"/>
                                </svg>
                                <div class="control-group">
                                    <button onclick="toggleOpacity()" class="btn btn-sm">åˆ‡æ¢é€æ˜åº¦</button>
                                    <button onclick="addBorder()" class="btn btn-sm">æ·»åŠ è¾¹æ¡†</button>
                                </div>
                            </div>
                            <div class="code-editor">
                                <div class="code-content">element.style.opacity = '0.5';</div>
                            </div>
                        </div>
                        
                        <div>
                            <h3>ç±»åæ“ä½œ</h3>
                            <div class="svg-example">
                                <svg width="150" height="100" viewBox="0 0 150 100" class="demo-svg">
                                    <style>
                                        .highlighted { fill: #FF5722; transform: scale(1.2); transform-origin: center; }
                                        .animated { transition: all 0.3s ease; }
                                    </style>
                                    <polygon id="polygon1" points="75,20 95,50 75,80 55,50" fill="#FF9800" class="animated"/>
                                </svg>
                                <div class="control-group">
                                    <button onclick="toggleHighlight()" class="btn btn-sm">åˆ‡æ¢é«˜äº®</button>
                                </div>
                            </div>
                            <div class="code-editor">
                                <div class="code-content">element.classList.toggle('highlighted');</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- äº‹ä»¶å¤„ç† -->
                <div class="card">
                    <h2>ğŸ‘† äº‹ä»¶å¤„ç†</h2>
                    <p>ä¸ºSVGå…ƒç´ æ·»åŠ å„ç§äº¤äº’äº‹ä»¶ã€‚</p>
                    
                    <div class="grid grid-2">
                        <div>
                            <h3>é¼ æ ‡äº‹ä»¶</h3>
                            <div class="svg-example">
                                <svg width="200" height="120" viewBox="0 0 200 120" class="demo-svg interactive-svg">
                                    <circle id="mouseCircle" cx="50" cy="60" r="15" fill="#2196F3"/>
                                    <rect id="mouseRect" x="100" y="40" width="30" height="30" fill="#4CAF50"/>
                                    <polygon id="mousePolygon" points="170,40 185,60 170,80 155,60" fill="#FF9800"/>
                                    <text id="eventText" x="100" y="100" text-anchor="middle" font-size="12" fill="#666">ç§»åŠ¨é¼ æ ‡åˆ°å›¾å½¢ä¸Š</text>
                                </svg>
                            </div>
                        </div>
                        
                        <div>
                            <h3>é”®ç›˜äº‹ä»¶</h3>
                            <div class="svg-example">
                                <svg width="200" height="120" viewBox="0 0 200 120" class="demo-svg" tabindex="0" id="keyboardSVG">
                                    <circle id="keyboardCircle" cx="100" cy="60" r="15" fill="#9C27B0"/>
                                    <text x="100" y="100" text-anchor="middle" font-size="12" fill="#666">ç‚¹å‡»èšç„¦ï¼ŒæŒ‰æ–¹å‘é”®ç§»åŠ¨</text>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- åŠ¨æ€åˆ›å»ºå…ƒç´  -->
                <div class="card">
                    <h2>âš¡ åŠ¨æ€åˆ›å»ºå…ƒç´ </h2>
                    <p>ä½¿ç”¨JavaScriptåŠ¨æ€åˆ›å»ºå’Œæ’å…¥SVGå…ƒç´ ã€‚</p>
                    
                    <div class="grid grid-2">
                        <div>
                            <h3>ç‚¹å‡»åˆ›å»ºå›¾å½¢</h3>
                            <div class="svg-example">
                                <svg width="200" height="120" viewBox="0 0 200 120" class="demo-svg drawing-canvas" id="createSVG">
                                    <text x="100" y="60" text-anchor="middle" font-size="14" fill="#999">ç‚¹å‡»ç©ºç™½å¤„åˆ›å»ºåœ†å½¢</text>
                                </svg>
                                <div class="control-group">
                                    <button onclick="clearCanvas()" class="btn btn-sm">æ¸…ç©ºç”»å¸ƒ</button>
                                    <button onclick="changeCreateMode()" class="btn btn-sm" id="modeBtn">åˆ›å»ºæ¨¡å¼ï¼šåœ†å½¢</button>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3>åŠ¨æ€è·¯å¾„ç»˜åˆ¶</h3>
                            <div class="svg-example">
                                <svg width="200" height="120" viewBox="0 0 200 120" class="demo-svg drawing-canvas" id="pathSVG">
                                    <path id="dynamicPath" d="" fill="none" stroke="#FF5722" stroke-width="3"/>
                                    <text x="100" y="60" text-anchor="middle" font-size="14" fill="#999">é¼ æ ‡æ‹–æ‹½ç»˜åˆ¶è·¯å¾„</text>
                                </svg>
                                <div class="control-group">
                                    <button onclick="clearPath()" class="btn btn-sm">æ¸…ç©ºè·¯å¾„</button>
                                    <button onclick="togglePathMode()" class="btn btn-sm" id="pathModeBtn">ç»˜åˆ¶æ¨¡å¼</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ‹–æ‹½äº¤äº’ -->
                <div class="card">
                    <h2>ğŸ–±ï¸ æ‹–æ‹½äº¤äº’</h2>
                    <p>å®ç°SVGå…ƒç´ çš„æ‹–æ‹½åŠŸèƒ½ã€‚</p>
                    
                    <div class="svg-example">
                        <svg width="100%" height="200" viewBox="0 0 400 200" class="demo-svg">
                            <defs>
                                <filter id="dropShadow" x="-50%" y="-50%" width="200%" height="200%">
                                    <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#00000040"/>
                                </filter>
                            </defs>
                            
                            <rect id="dragRect" x="50" y="80" width="40" height="30" fill="#FF5722" class="draggable" filter="url(#dropShadow)"/>
                            <circle id="dragCircle" cx="150" cy="100" r="20" fill="#2196F3" class="draggable" filter="url(#dropShadow)"/>
                            <polygon id="dragPolygon" points="250,80 270,100 250,120 230,100" fill="#4CAF50" class="draggable" filter="url(#dropShadow)"/>
                            
                            <text x="200" y="30" text-anchor="middle" font-size="14" fill="#666">æ‹–æ‹½ä¸Šé¢çš„å›¾å½¢</text>
                            <text x="200" y="180" text-anchor="middle" font-size="12" fill="#999">æ”¯æŒè¾¹ç•Œé™åˆ¶å’Œç¢°æ’æ£€æµ‹</text>
                        </svg>
                    </div>
                </div>

                <!-- åŠ¨ç”»æ§åˆ¶ -->
                <div class="card">
                    <h2>ğŸ¬ åŠ¨ç”»æ§åˆ¶</h2>
                    <p>ä½¿ç”¨JavaScriptæ§åˆ¶CSSå’ŒSMILåŠ¨ç”»çš„æ’­æ”¾ã€æš‚åœå’Œé‡å¯ã€‚</p>
                    
                    <div class="grid grid-2">
                        <div>
                            <h3>CSSåŠ¨ç”»æ§åˆ¶</h3>
                            <div class="svg-example">
                                <svg width="200" height="120" viewBox="0 0 200 120" class="demo-svg">
                                    <style>
                                        @keyframes cssRotate {
                                            from { transform: rotate(0deg); }
                                            to { transform: rotate(360deg); }
                                        }
                                        .css-animated {
                                            animation: cssRotate 3s linear infinite;
                                            transform-origin: center;
                                        }
                                    </style>
                                    <rect id="cssAnimRect" x="85" y="45" width="30" height="30" fill="#FF9800"/>
                                </svg>
                                <div class="control-group">
                                    <button onclick="toggleCSSAnimation()" class="btn btn-sm" id="cssAnimBtn">å¼€å§‹åŠ¨ç”»</button>
                                    <button onclick="pauseCSSAnimation()" class="btn btn-sm">æš‚åœ/ç»§ç»­</button>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3>SMILåŠ¨ç”»æ§åˆ¶</h3>
                            <div class="svg-example">
                                <svg width="200" height="120" viewBox="0 0 200 120" class="demo-svg">
                                    <circle cx="100" cy="60" r="15" fill="#9C27B0">
                                        <animate id="smilAnim" attributeName="r" values="15;25;15" dur="2s" begin="indefinite" repeatCount="indefinite"/>
                                        <animate attributeName="fill" values="#9C27B0;#E91E63;#9C27B0" dur="2s" begin="smilAnim.begin" repeatCount="indefinite"/>
                                    </circle>
                                </svg>
                                <div class="control-group">
                                    <button onclick="startSMILAnimation()" class="btn btn-sm">å¼€å§‹</button>
                                    <button onclick="stopSMILAnimation()" class="btn btn-sm">åœæ­¢</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- é«˜çº§äº¤äº’ -->
                <div class="card">
                    <h2>ğŸš€ é«˜çº§äº¤äº’æŠ€æœ¯</h2>
                    <p>å®ç°å¤æ‚çš„äº¤äº’æ•ˆæœå’Œæ•°æ®å¯è§†åŒ–ã€‚</p>
                    
                    <div class="svg-example">
                        <svg width="100%" height="250" viewBox="0 0 400 250" class="demo-svg">
                            <!-- æ•°æ®å¯è§†åŒ–å›¾è¡¨ -->
                            <g id="chart">
                                <text x="200" y="25" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">äº¤äº’å¼æ•°æ®å›¾è¡¨</text>
                                
                                <!-- åæ ‡è½´ -->
                                <line x1="50" y1="200" x2="350" y2="200" stroke="#666" stroke-width="2"/>
                                <line x1="50" y1="200" x2="50" y2="50" stroke="#666" stroke-width="2"/>
                                
                                <!-- æ•°æ®ç‚¹ -->
                                <g id="dataPoints">
                                    <!-- åŠ¨æ€ç”Ÿæˆçš„æ•°æ®ç‚¹å°†æ’å…¥è¿™é‡Œ -->
                                </g>
                                
                                <!-- æç¤ºæ¡† -->
                                <g id="tooltip" style="display: none;">
                                    <rect x="0" y="0" width="80" height="40" fill="rgba(0,0,0,0.8)" rx="5"/>
                                    <text x="10" y="15" fill="white" font-size="12" id="tooltipTitle">æ•°æ®ç‚¹</text>
                                    <text x="10" y="30" fill="white" font-size="11" id="tooltipValue">å€¼: 0</text>
                                </g>
                            </g>
                        </svg>
                        
                        <div class="control-group">
                            <button onclick="generateRandomData()" class="btn btn-sm">ç”Ÿæˆéšæœºæ•°æ®</button>
                            <button onclick="animateChart()" class="btn btn-sm">åŠ¨ç”»å±•ç¤º</button>
                            <button onclick="clearChart()" class="btn btn-sm">æ¸…ç©ºå›¾è¡¨</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¾§è¾¹æ ä»£ç ç¤ºä¾‹ -->
            <div class="demo-sidebar">
                <h3>ğŸ’» JavaScriptä»£ç ç¤ºä¾‹</h3>
                
                <div class="code-section">
                    <h4>è·å–SVGå…ƒç´ </h4>
                    <div class="code-editor">
                        <div class="code-content">// è·å–SVGå…ƒç´ 
const circle = document.getElementById('myCircle');
const rect = document.querySelector('rect');
const allCircles = document.querySelectorAll('circle');</div>
                    </div>
                </div>
                
                <div class="code-section">
                    <h4>åˆ›å»ºSVGå…ƒç´ </h4>
                    <div class="code-editor">
                        <div class="code-content">// åˆ›å»ºSVGå…ƒç´ 
const circle = document.createElementNS(
  'http://www.w3.org/2000/svg', 'circle'
);
circle.setAttribute('cx', '50');
circle.setAttribute('cy', '50');
circle.setAttribute('r', '20');
svg.appendChild(circle);</div>
                    </div>
                </div>
                
                <div class="code-section">
                    <h4>äº‹ä»¶å¤„ç†</h4>
                    <div class="code-editor">
                        <div class="code-content">// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
element.addEventListener('click', function(e) {
  console.log('ç‚¹å‡»äº†å…ƒç´ ');
});

// é¼ æ ‡äº‹ä»¶
element.addEventListener('mouseover', handleMouseOver);
element.addEventListener('mouseout', handleMouseOut);</div>
                    </div>
                </div>
                
                <div class="code-section">
                    <h4>åŠ¨ç”»æ§åˆ¶</h4>
                    <div class="code-editor">
                        <div class="code-content">// CSSåŠ¨ç”»æ§åˆ¶
element.style.animationPlayState = 'paused';
element.style.animationPlayState = 'running';

// SMILåŠ¨ç”»æ§åˆ¶
animation.beginElement(); // å¼€å§‹
animation.endElement();   // ç»“æŸ</div>
                    </div>
                </div>
                
                <div class="code-section">
                    <h4>åæ ‡è½¬æ¢</h4>
                    <div class="code-editor">
                        <div class="code-content">// è·å–SVGåæ ‡
const pt = svg.createSVGPoint();
pt.x = event.clientX;
pt.y = event.clientY;
const svgP = pt.matrixTransform(
  svg.getScreenCTM().inverse()
);</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¯¼èˆª -->
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <a href="../smil-animations/" class="btn">â† ä¸Šä¸€ç« ï¼šSMILåŠ¨ç”»ç³»ç»Ÿ</a>
                <a href="../index.html" class="btn btn-primary">è¿”å›åŠ¨ç”»ä¸äº¤äº’ â†’</a>
            </div>
        </div>
    </div>

    <script src="../../common/utils.js"></script>
    <script>
        // å…¨å±€å˜é‡
        let createMode = 'circle';
        let isDrawing = false;
        let currentPath = '';
        let dragElement = null;
        let offset = { x: 0, y: 0 };
        let cssAnimationRunning = false;
        let cssAnimationPaused = false;

        // ===== åŸºç¡€DOMæ“ä½œ =====
        function changeCircleSize() {
            const circle = document.getElementById('circle1');
            const currentR = parseInt(circle.getAttribute('r'));
            const newR = currentR === 20 ? 30 : 20;
            circle.setAttribute('r', newR);
        }

        function changeCircleColor() {
            const circle = document.getElementById('circle1');
            const colors = ['#2196F3', '#FF5722', '#4CAF50', '#FF9800'];
            const currentColor = circle.getAttribute('fill');
            const currentIndex = colors.indexOf(currentColor);
            const newIndex = (currentIndex + 1) % colors.length;
            circle.setAttribute('fill', colors[newIndex]);
        }

        function toggleOpacity() {
            const rect = document.getElementById('rect1');
            const currentOpacity = rect.style.opacity || '1';
            rect.style.opacity = currentOpacity === '1' ? '0.5' : '1';
        }

        function addBorder() {
            const rect = document.getElementById('rect1');
            const currentStroke = rect.getAttribute('stroke');
            if (currentStroke) {
                rect.removeAttribute('stroke');
                rect.removeAttribute('stroke-width');
            } else {
                rect.setAttribute('stroke', '#333');
                rect.setAttribute('stroke-width', '2');
            }
        }

        function toggleHighlight() {
            const polygon = document.getElementById('polygon1');
            polygon.classList.toggle('highlighted');
        }

        // ===== äº‹ä»¶å¤„ç† =====
        function setupMouseEvents() {
            const shapes = ['mouseCircle', 'mouseRect', 'mousePolygon'];
            const eventText = document.getElementById('eventText');
            
            shapes.forEach(id => {
                const element = document.getElementById(id);
                
                element.addEventListener('mouseover', function() {
                    eventText.textContent = `é¼ æ ‡æ‚¬åœåœ¨ ${id} ä¸Š`;
                    this.style.opacity = '0.7';
                });
                
                element.addEventListener('mouseout', function() {
                    eventText.textContent = 'ç§»åŠ¨é¼ æ ‡åˆ°å›¾å½¢ä¸Š';
                    this.style.opacity = '1';
                });
                
                element.addEventListener('click', function() {
                    eventText.textContent = `ç‚¹å‡»äº† ${id}`;
                    this.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 200);
                });
            });
        }

        function setupKeyboardEvents() {
            const svg = document.getElementById('keyboardSVG');
            const circle = document.getElementById('keyboardCircle');
            
            svg.addEventListener('keydown', function(e) {
                const step = 10;
                let cx = parseInt(circle.getAttribute('cx'));
                let cy = parseInt(circle.getAttribute('cy'));
                
                switch(e.key) {
                    case 'ArrowUp':
                        cy = Math.max(15, cy - step);
                        break;
                    case 'ArrowDown':
                        cy = Math.min(105, cy + step);
                        break;
                    case 'ArrowLeft':
                        cx = Math.max(15, cx - step);
                        break;
                    case 'ArrowRight':
                        cx = Math.min(185, cx + step);
                        break;
                }
                
                circle.setAttribute('cx', cx);
                circle.setAttribute('cy', cy);
                e.preventDefault();
            });
        }

        // ===== åŠ¨æ€åˆ›å»ºå…ƒç´  =====
        function setupCreateCanvas() {
            const svg = document.getElementById('createSVG');
            
            svg.addEventListener('click', function(e) {
                const rect = svg.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width) * 200;
                const y = ((e.clientY - rect.top) / rect.height) * 120;
                
                if (e.target === svg) {
                    createShape(svg, x, y);
                }
            });
        }

        function createShape(svg, x, y) {
            const colors = ['#FF5722', '#2196F3', '#4CAF50', '#FF9800', '#9C27B0'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            let element;
            
            switch(createMode) {
                case 'circle':
                    element = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    element.setAttribute('cx', x);
                    element.setAttribute('cy', y);
                    element.setAttribute('r', Math.random() * 10 + 5);
                    break;
                case 'rect':
                    element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    element.setAttribute('x', x - 10);
                    element.setAttribute('y', y - 10);
                    element.setAttribute('width', Math.random() * 20 + 10);
                    element.setAttribute('height', Math.random() * 20 + 10);
                    break;
                case 'polygon':
                    element = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                    const size = Math.random() * 10 + 8;
                    element.setAttribute('points', `${x},${y-size} ${x+size},${y+size} ${x-size},${y+size}`);
                    break;
            }
            
            element.setAttribute('fill', color);
            element.style.cursor = 'pointer';
            
            // æ·»åŠ ç‚¹å‡»åˆ é™¤åŠŸèƒ½
            element.addEventListener('click', function(e) {
                e.stopPropagation();
                this.remove();
            });
            
            svg.appendChild(element);
        }

        function clearCanvas() {
            const svg = document.getElementById('createSVG');
            const shapes = svg.querySelectorAll('circle, rect, polygon');
            shapes.forEach(shape => shape.remove());
        }

        function changeCreateMode() {
            const modes = ['circle', 'rect', 'polygon'];
            const currentIndex = modes.indexOf(createMode);
            createMode = modes[(currentIndex + 1) % modes.length];
            document.getElementById('modeBtn').textContent = `åˆ›å»ºæ¨¡å¼ï¼š${createMode === 'circle' ? 'åœ†å½¢' : createMode === 'rect' ? 'çŸ©å½¢' : 'ä¸‰è§’å½¢'}`;
        }

        // ===== è·¯å¾„ç»˜åˆ¶ =====
        function setupPathDrawing() {
            const svg = document.getElementById('pathSVG');
            const path = document.getElementById('dynamicPath');
            
            svg.addEventListener('mousedown', function(e) {
                if (e.target === svg) {
                    isDrawing = true;
                    const rect = svg.getBoundingClientRect();
                    const x = ((e.clientX - rect.left) / rect.width) * 200;
                    const y = ((e.clientY - rect.top) / rect.height) * 120;
                    currentPath = `M${x},${y}`;
                    path.setAttribute('d', currentPath);
                }
            });
            
            svg.addEventListener('mousemove', function(e) {
                if (isDrawing) {
                    const rect = svg.getBoundingClientRect();
                    const x = ((e.clientX - rect.left) / rect.width) * 200;
                    const y = ((e.clientY - rect.top) / rect.height) * 120;
                    currentPath += ` L${x},${y}`;
                    path.setAttribute('d', currentPath);
                }
            });
            
            svg.addEventListener('mouseup', function() {
                isDrawing = false;
            });
        }

        function clearPath() {
            document.getElementById('dynamicPath').setAttribute('d', '');
            currentPath = '';
        }

        function togglePathMode() {
            const btn = document.getElementById('pathModeBtn');
            btn.textContent = btn.textContent === 'ç»˜åˆ¶æ¨¡å¼' ? 'æŸ¥çœ‹æ¨¡å¼' : 'ç»˜åˆ¶æ¨¡å¼';
        }

        // ===== æ‹–æ‹½åŠŸèƒ½ =====
        function setupDragAndDrop() {
            const draggables = document.querySelectorAll('.draggable');
            
            draggables.forEach(element => {
                element.addEventListener('mousedown', startDrag);
            });
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        function startDrag(e) {
            dragElement = e.target;
            const svg = dragElement.closest('svg');
            const rect = svg.getBoundingClientRect();
            
            // è®¡ç®—é¼ æ ‡ç›¸å¯¹äºSVGçš„ä½ç½®
            const mouseX = ((e.clientX - rect.left) / rect.width) * 400;
            const mouseY = ((e.clientY - rect.top) / rect.height) * 200;
            
            // è®¡ç®—åç§»é‡
            if (dragElement.tagName === 'circle') {
                offset.x = mouseX - parseFloat(dragElement.getAttribute('cx'));
                offset.y = mouseY - parseFloat(dragElement.getAttribute('cy'));
            } else if (dragElement.tagName === 'rect') {
                offset.x = mouseX - parseFloat(dragElement.getAttribute('x'));
                offset.y = mouseY - parseFloat(dragElement.getAttribute('y'));
            } else if (dragElement.tagName === 'polygon') {
                const points = dragElement.getAttribute('points').split(' ');
                const firstPoint = points[0].split(',');
                offset.x = mouseX - parseFloat(firstPoint[0]);
                offset.y = mouseY - parseFloat(firstPoint[1]);
            }
            
            dragElement.style.cursor = 'grabbing';
            e.preventDefault();
        }

        function drag(e) {
            if (!dragElement) return;
            
            const svg = dragElement.closest('svg');
            const rect = svg.getBoundingClientRect();
            
            const mouseX = ((e.clientX - rect.left) / rect.width) * 400;
            const mouseY = ((e.clientY - rect.top) / rect.height) * 200;
            
            const newX = mouseX - offset.x;
            const newY = mouseY - offset.y;
            
            // è¾¹ç•Œé™åˆ¶
            if (dragElement.tagName === 'circle') {
                const r = parseFloat(dragElement.getAttribute('r'));
                const clampedX = Math.max(r, Math.min(400 - r, newX));
                const clampedY = Math.max(r, Math.min(200 - r, newY));
                dragElement.setAttribute('cx', clampedX);
                dragElement.setAttribute('cy', clampedY);
            } else if (dragElement.tagName === 'rect') {
                const w = parseFloat(dragElement.getAttribute('width'));
                const h = parseFloat(dragElement.getAttribute('height'));
                const clampedX = Math.max(0, Math.min(400 - w, newX));
                const clampedY = Math.max(0, Math.min(200 - h, newY));
                dragElement.setAttribute('x', clampedX);
                dragElement.setAttribute('y', clampedY);
            }
        }

        function stopDrag() {
            if (dragElement) {
                dragElement.style.cursor = 'move';
                dragElement = null;
            }
        }

        // ===== åŠ¨ç”»æ§åˆ¶ =====
        function toggleCSSAnimation() {
            const rect = document.getElementById('cssAnimRect');
            const btn = document.getElementById('cssAnimBtn');
            
            if (!cssAnimationRunning) {
                rect.classList.add('css-animated');
                btn.textContent = 'åœæ­¢åŠ¨ç”»';
                cssAnimationRunning = true;
            } else {
                rect.classList.remove('css-animated');
                btn.textContent = 'å¼€å§‹åŠ¨ç”»';
                cssAnimationRunning = false;
                cssAnimationPaused = false;
            }
        }

        function pauseCSSAnimation() {
            const rect = document.getElementById('cssAnimRect');
            
            if (cssAnimationRunning) {
                if (!cssAnimationPaused) {
                    rect.style.animationPlayState = 'paused';
                    cssAnimationPaused = true;
                } else {
                    rect.style.animationPlayState = 'running';
                    cssAnimationPaused = false;
                }
            }
        }

        function startSMILAnimation() {
            const animation = document.getElementById('smilAnim');
            animation.beginElement();
        }

        function stopSMILAnimation() {
            const animation = document.getElementById('smilAnim');
            animation.endElement();
        }

        // ===== æ•°æ®å¯è§†åŒ– =====
        function generateRandomData() {
            const dataPoints = document.getElementById('dataPoints');
            dataPoints.innerHTML = '';
            
            const data = [];
            for (let i = 0; i < 8; i++) {
                data.push({
                    x: 70 + i * 35,
                    y: 200 - Math.random() * 130,
                    value: Math.floor(Math.random() * 100)
                });
            }
            
            data.forEach((point, index) => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', point.x);
                circle.setAttribute('cy', point.y);
                circle.setAttribute('r', '5');
                circle.setAttribute('fill', '#2196F3');
                circle.setAttribute('stroke', '#fff');
                circle.setAttribute('stroke-width', '2');
                circle.style.cursor = 'pointer';
                
                // æ·»åŠ æ‚¬åœæ•ˆæœ
                circle.addEventListener('mouseover', function(e) {
                    this.setAttribute('r', '7');
                    showTooltip(e, point.value, index);
                });
                
                circle.addEventListener('mouseout', function() {
                    this.setAttribute('r', '5');
                    hideTooltip();
                });
                
                dataPoints.appendChild(circle);
            });
        }

        function showTooltip(e, value, index) {
            const tooltip = document.getElementById('tooltip');
            const tooltipTitle = document.getElementById('tooltipTitle');
            const tooltipValue = document.getElementById('tooltipValue');
            
            tooltipTitle.textContent = `æ•°æ®ç‚¹ ${index + 1}`;
            tooltipValue.textContent = `å€¼: ${value}`;
            
            tooltip.setAttribute('transform', `translate(${e.target.getAttribute('cx') - 40}, ${e.target.getAttribute('cy') - 50})`);
            tooltip.style.display = 'block';
        }

        function hideTooltip() {
            document.getElementById('tooltip').style.display = 'none';
        }

        function animateChart() {
            const circles = document.querySelectorAll('#dataPoints circle');
            circles.forEach((circle, index) => {
                circle.style.opacity = '0';
                circle.style.transform = 'scale(0)';
                circle.style.transition = 'all 0.5s ease';
                
                setTimeout(() => {
                    circle.style.opacity = '1';
                    circle.style.transform = 'scale(1)';
                }, index * 100);
            });
        }

        function clearChart() {
            document.getElementById('dataPoints').innerHTML = '';
        }

        // ===== åˆå§‹åŒ– =====
        document.addEventListener('DOMContentLoaded', function() {
            setupMouseEvents();
            setupKeyboardEvents();
            setupCreateCanvas();
            setupPathDrawing();
            setupDragAndDrop();
            generateRandomData();
        });
    </script>
</body>
</html> 