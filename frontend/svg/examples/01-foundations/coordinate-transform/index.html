<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>坐标系统和变换 - SVG学习示例</title>
    <link rel="stylesheet" href="../../common/styles.css">
    <link rel="stylesheet" href="../../common/demo.css">
</head>
<body class="demo-page">
    <div class="demo-header">
        <div class="container">
            <nav class="breadcrumb">
                <ol class="breadcrumb-list">
                    <li class="breadcrumb-item"><a href="../../index.html">示例首页</a></li>
                    <li class="breadcrumb-item"><a href="../index.html">基础入门</a></li>
                    <li class="breadcrumb-item active">坐标系统和变换</li>
                </ol>
            </nav>
            <h1 class="demo-title">坐标系统和变换</h1>
            <p class="demo-subtitle">理解SVG坐标系统，掌握各种变换操作</p>
        </div>
    </div>

    <div class="container">
        <!-- SVG坐标系统 -->
        <div class="card">
            <h2>📐 SVG坐标系统</h2>
            <p>SVG使用笛卡尔坐标系统，原点(0,0)在左上角，X轴向右，Y轴向下。</p>
            
            <div class="grid grid-2">
                <div>
                    <h3>坐标系统演示</h3>
                    <div class="svg-example">
                        <svg width="200" height="150" viewBox="0 0 200 150">
                            <!-- 坐标轴 -->
                            <line x1="0" y1="75" x2="200" y2="75" stroke="#ddd" stroke-width="1"/>
                            <line x1="100" y1="0" x2="100" y2="150" stroke="#ddd" stroke-width="1"/>
                            
                            <!-- 坐标点 -->
                            <circle cx="50" cy="50" r="3" fill="red"/>
                            <text x="55" y="45" font-size="12" fill="red">(50,50)</text>
                            
                            <circle cx="150" cy="100" r="3" fill="blue"/>
                            <text x="155" y="95" font-size="12" fill="blue">(150,100)</text>
                            
                            <!-- 原点 -->
                            <circle cx="0" cy="0" r="3" fill="green"/>
                            <text x="5" y="15" font-size="12" fill="green">(0,0)</text>
                        </svg>
                        <div class="svg-description">SVG坐标系统示意图</div>
                    </div>
                </div>
                
                <div>
                    <h3>viewBox概念</h3>
                    <div class="svg-example">
                        <svg width="200" height="150" viewBox="50 25 100 75">
                            <rect x="0" y="0" width="200" height="150" fill="none" stroke="#ccc" stroke-width="2"/>
                            <rect x="50" y="25" width="100" height="75" fill="lightblue" fill-opacity="0.3" stroke="blue" stroke-width="2"/>
                            <text x="100" y="65" text-anchor="middle" font-size="14" fill="blue">viewBox区域</text>
                        </svg>
                        <div class="svg-description">viewBox="50 25 100 75"</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 基本变换 -->
        <div class="card">
            <h2>🔄 基本变换</h2>
            
            <div class="grid grid-3">
                <!-- 平移 -->
                <div>
                    <h3>平移 (translate)</h3>
                    <div class="svg-example">
                        <svg width="150" height="120" viewBox="0 0 150 120">
                            <!-- 原始位置 -->
                            <rect x="20" y="20" width="30" height="20" fill="#ccc" fill-opacity="0.5"/>
                            <text x="35" y="15" text-anchor="middle" font-size="10" fill="#666">原始</text>
                            
                            <!-- 平移后 -->
                            <rect x="20" y="20" width="30" height="20" fill="red" transform="translate(40,30)"/>
                            <text x="75" y="35" text-anchor="middle" font-size="10" fill="red">translate(40,30)</text>
                            
                            <!-- 箭头 -->
                            <path d="M 50 30 L 85 60" stroke="orange" stroke-width="2" marker-end="url(#arrow)"/>
                            <defs>
                                <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <path d="M0,0 L0,6 L9,3 z" fill="orange"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>
                
                <!-- 旋转 -->
                <div>
                    <h3>旋转 (rotate)</h3>
                    <div class="svg-example">
                        <svg width="150" height="120" viewBox="0 0 150 120">
                            <!-- 原始位置 -->
                            <rect x="60" y="50" width="30" height="20" fill="#ccc" fill-opacity="0.5"/>
                            
                            <!-- 旋转后 -->
                            <rect x="60" y="50" width="30" height="20" fill="green" transform="rotate(45 75 60)"/>
                            
                            <!-- 旋转中心 -->
                            <circle cx="75" cy="60" r="2" fill="red"/>
                            <text x="75" y="45" text-anchor="middle" font-size="10" fill="green">rotate(45°)</text>
                        </svg>
                    </div>
                </div>
                
                <!-- 缩放 -->
                <div>
                    <h3>缩放 (scale)</h3>
                    <div class="svg-example">
                        <svg width="150" height="120" viewBox="0 0 150 120">
                            <!-- 原始位置 -->
                            <rect x="65" y="55" width="20" height="15" fill="#ccc" fill-opacity="0.5"/>
                            
                            <!-- 缩放后 -->
                            <rect x="65" y="55" width="20" height="15" fill="blue" transform="scale(1.5)"/>
                            
                            <text x="75" y="40" text-anchor="middle" font-size="10" fill="blue">scale(1.5)</text>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- 组合变换 -->
        <div class="card">
            <h2>🌀 组合变换</h2>
            <p>可以同时应用多个变换，变换的顺序很重要。</p>
            
            <div class="grid grid-2">
                <div>
                    <h3>先平移后旋转</h3>
                    <div class="svg-example">
                        <svg width="200" height="150" viewBox="0 0 200 150">
                            <!-- 原始 -->
                            <rect x="20" y="60" width="25" height="15" fill="#ccc" fill-opacity="0.5"/>
                            <text x="32" y="55" text-anchor="middle" font-size="10" fill="#666">原始</text>
                            
                            <!-- 先平移后旋转 -->
                            <rect x="20" y="60" width="25" height="15" fill="purple" 
                                  transform="translate(60,20) rotate(30)"/>
                            <text x="100" y="40" font-size="10" fill="purple">translate(60,20) rotate(30)</text>
                        </svg>
                    </div>
                </div>
                
                <div>
                    <h3>先旋转后平移</h3>
                    <div class="svg-example">
                        <svg width="200" height="150" viewBox="0 0 200 150">
                            <!-- 原始 -->
                            <rect x="20" y="60" width="25" height="15" fill="#ccc" fill-opacity="0.5"/>
                            <text x="32" y="55" text-anchor="middle" font-size="10" fill="#666">原始</text>
                            
                            <!-- 先旋转后平移 -->
                            <rect x="20" y="60" width="25" height="15" fill="orange" 
                                  transform="rotate(30) translate(60,20)"/>
                            <text x="100" y="100" font-size="10" fill="orange">rotate(30) translate(60,20)</text>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- 变换矩阵 -->
        <div class="card">
            <h2>🧮 变换矩阵</h2>
            <p>所有变换都可以用矩阵表示，matrix()函数提供最大的灵活性。</p>
            
            <div class="alert alert-info">
                <strong>变换矩阵：</strong> matrix(a b c d e f)<br>
                a, d: 缩放；b, c: 倾斜；e, f: 平移
            </div>
            
            <div class="svg-example">
                <svg width="300" height="200" viewBox="0 0 300 200">
                    <!-- 网格背景 -->
                    <defs>
                        <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                            <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                        </pattern>
                    </defs>
                    <rect width="300" height="200" fill="url(#grid)"/>
                    
                    <!-- 原始矩形 -->
                    <rect x="50" y="50" width="40" height="30" fill="red" fill-opacity="0.3"/>
                    <text x="70" y="45" text-anchor="middle" font-size="12" fill="red">原始</text>
                    
                    <!-- 矩阵变换后 -->
                    <rect x="50" y="50" width="40" height="30" fill="blue" 
                          transform="matrix(1.5 0.5 -0.5 1.5 100 50)"/>
                    <text x="200" y="45" text-anchor="middle" font-size="12" fill="blue">matrix(1.5 0.5 -0.5 1.5 100 50)</text>
                </svg>
            </div>
        </div>

        <!-- 交互式变换编辑器 -->
        <div class="card">
            <h2>🎮 交互式变换编辑器</h2>
            
            <div class="grid grid-2">
                <div>
                    <div class="control-section">
                        <h4>平移</h4>
                        <div class="control-row">
                            <label>X偏移: <span id="translateXValue">0</span></label>
                            <input type="range" id="translateX" min="-100" max="100" value="0">
                        </div>
                        <div class="control-row">
                            <label>Y偏移: <span id="translateYValue">0</span></label>
                            <input type="range" id="translateY" min="-100" max="100" value="0">
                        </div>
                        
                        <h4>旋转</h4>
                        <div class="control-row">
                            <label>角度: <span id="rotateValue">0</span>°</label>
                            <input type="range" id="rotate" min="0" max="360" value="0">
                        </div>
                        
                        <h4>缩放</h4>
                        <div class="control-row">
                            <label>X缩放: <span id="scaleXValue">1</span></label>
                            <input type="range" id="scaleX" min="0.5" max="2" step="0.1" value="1">
                        </div>
                        <div class="control-row">
                            <label>Y缩放: <span id="scaleYValue">1</span></label>
                            <input type="range" id="scaleY" min="0.5" max="2" step="0.1" value="1">
                        </div>
                        
                        <button onclick="resetTransform()" class="btn">重置</button>
                    </div>
                </div>
                
                <div>
                    <div class="svg-example">
                        <svg width="250" height="200" viewBox="0 0 250 200">
                            <!-- 网格 -->
                            <rect width="250" height="200" fill="url(#grid)"/>
                            
                            <!-- 参考线 -->
                            <line x1="125" y1="0" x2="125" y2="200" stroke="#ddd" stroke-width="1"/>
                            <line x1="0" y1="100" x2="250" y2="100" stroke="#ddd" stroke-width="1"/>
                            
                            <!-- 原始形状（半透明） -->
                            <rect x="100" y="75" width="50" height="30" fill="#ccc" fill-opacity="0.3"/>
                            
                            <!-- 变换后的形状 -->
                            <rect id="transformRect" x="100" y="75" width="50" height="30" fill="blue"/>
                        </svg>
                    </div>
                    
                    <div class="code-editor">
                        <div class="code-header">
                            <div class="code-title">变换代码</div>
                        </div>
                        <div class="code-content" id="transformCode">transform=""</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 导航 -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 2rem;">
            <a href="../text-images/" class="btn">← 上一章：文本和图像</a>
            <a href="../groups-reuse/" class="btn btn-primary">下一章：分组和重用 →</a>
        </div>
    </div>

    <script src="../../common/utils.js"></script>
    <script>
        // 变换编辑器
        const translateX = document.getElementById('translateX');
        const translateY = document.getElementById('translateY');
        const rotate = document.getElementById('rotate');
        const scaleX = document.getElementById('scaleX');
        const scaleY = document.getElementById('scaleY');
        
        const translateXValue = document.getElementById('translateXValue');
        const translateYValue = document.getElementById('translateYValue');
        const rotateValue = document.getElementById('rotateValue');
        const scaleXValue = document.getElementById('scaleXValue');
        const scaleYValue = document.getElementById('scaleYValue');
        
        const transformRect = document.getElementById('transformRect');
        const transformCode = document.getElementById('transformCode');

        function updateTransform() {
            const tx = translateX.value;
            const ty = translateY.value;
            const r = rotate.value;
            const sx = scaleX.value;
            const sy = scaleY.value;
            
            // 更新数值显示
            translateXValue.textContent = tx;
            translateYValue.textContent = ty;
            rotateValue.textContent = r;
            scaleXValue.textContent = sx;
            scaleYValue.textContent = sy;
            
            // 构建变换字符串
            let transforms = [];
            if (tx != 0 || ty != 0) transforms.push(`translate(${tx},${ty})`);
            if (r != 0) transforms.push(`rotate(${r})`);
            if (sx != 1 || sy != 1) transforms.push(`scale(${sx},${sy})`);
            
            const transformString = transforms.join(' ');
            
            // 应用变换
            transformRect.setAttribute('transform', transformString);
            
            // 更新代码显示
            transformCode.textContent = `transform="${transformString}"`;
        }

        function resetTransform() {
            translateX.value = 0;
            translateY.value = 0;
            rotate.value = 0;
            scaleX.value = 1;
            scaleY.value = 1;
            updateTransform();
        }

        // 绑定事件
        [translateX, translateY, rotate, scaleX, scaleY].forEach(slider => {
            slider.addEventListener('input', updateTransform);
        });

        // 初始化
        updateTransform();
    </script>
</body>
</html> 