<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvasç»˜å›¾ä¸Šä¸‹æ–‡ç¤ºä¾‹</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .example-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .example-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .description {
            background-color: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin-bottom: 20px;
            border-radius: 0 5px 5px 0;
        }
        canvas {
            border: 2px solid #34495e;
            margin: 10px 0;
            display: block;
            background: white;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #2980b9;
        }
        .controls {
            margin: 15px 0;
        }
        .slider-control {
            margin: 10px 0;
        }
        .slider-control label {
            display: inline-block;
            width: 100px;
            font-weight: bold;
        }
        input[type="range"] {
            width: 200px;
            margin: 0 10px;
        }
        .code-hint {
            font-family: 'Courier New', monospace;
            background: #f4f4f4;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›ï¸ Canvasç»˜å›¾ä¸Šä¸‹æ–‡ç¤ºä¾‹</h1>
        
        <!-- ç¤ºä¾‹1: çŠ¶æ€ä¿å­˜ä¸æ¢å¤ -->
        <div class="example-section">
            <div class="example-title">1. CanvasçŠ¶æ€ä¿å­˜ä¸æ¢å¤</div>
            <div class="description">
                <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨save()å’Œrestore()ç®¡ç†Canvasç»˜å›¾çŠ¶æ€ã€‚<br>
                <strong>æŠ€æœ¯è¦ç‚¹ï¼š</strong>
                <span class="code-hint">ctx.save()</span>ã€
                <span class="code-hint">ctx.restore()</span>ã€
                çŠ¶æ€æ ˆç®¡ç†
            </div>
            
            <canvas id="stateCanvas" width="600" height="200"></canvas>
            
            <div class="controls">
                <button onclick="demonstrateState()">ğŸ”„ æ¼”ç¤ºçŠ¶æ€ç®¡ç†</button>
                <button onclick="clearCanvas('stateCanvas')">ğŸ—‘ï¸ æ¸…é™¤ç”»å¸ƒ</button>
            </div>
        </div>

        <!-- ç¤ºä¾‹2: åæ ‡å˜æ¢ -->
        <div class="example-section">
            <div class="example-title">2. åæ ‡å˜æ¢æ“ä½œ</div>
            <div class="description">
                <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>æ¼”ç¤ºå¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰åæ ‡å˜æ¢æ“ä½œã€‚<br>
                <strong>æŠ€æœ¯è¦ç‚¹ï¼š</strong>
                <span class="code-hint">translate()</span>ã€
                <span class="code-hint">rotate()</span>ã€
                <span class="code-hint">scale()</span>
            </div>
            
            <canvas id="transformCanvas" width="600" height="400"></canvas>
            
            <div class="controls">
                <div class="slider-control">
                    <label>å¹³ç§»X:</label>
                    <input type="range" id="translateX" min="-200" max="200" value="0" oninput="updateTransforms()">
                    <span id="translateXValue">0</span>
                </div>
                <div class="slider-control">
                    <label>å¹³ç§»Y:</label>
                    <input type="range" id="translateY" min="-200" max="200" value="0" oninput="updateTransforms()">
                    <span id="translateYValue">0</span>
                </div>
                <div class="slider-control">
                    <label>æ—‹è½¬è§’åº¦:</label>
                    <input type="range" id="rotation" min="0" max="360" value="0" oninput="updateTransforms()">
                    <span id="rotationValue">0</span>Â°
                </div>
                <div class="slider-control">
                    <label>ç¼©æ”¾æ¯”ä¾‹:</label>
                    <input type="range" id="scale" min="0.5" max="3" step="0.1" value="1" oninput="updateTransforms()">
                    <span id="scaleValue">1</span>
                </div>
                <button onclick="resetTransforms()">ğŸ”„ é‡ç½®å˜æ¢</button>
                <button onclick="animateTransforms()">âœ¨ åŠ¨ç”»æ¼”ç¤º</button>
            </div>
        </div>

        <!-- ç¤ºä¾‹3: å¤åˆæ“ä½œ -->
        <div class="example-section">
            <div class="example-title">3. å…¨å±€å¤åˆæ“ä½œ</div>
            <div class="description">
                <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>æ¼”ç¤ºä¸åŒçš„globalCompositeOperationæ•ˆæœã€‚<br>
                <strong>æŠ€æœ¯è¦ç‚¹ï¼š</strong>
                <span class="code-hint">globalCompositeOperation</span>ã€
                å›¾å½¢æ··åˆæ¨¡å¼
            </div>
            
            <canvas id="compositeCanvas" width="600" height="300"></canvas>
            
            <div class="controls">
                <button onclick="showCompositeMode('source-over')">source-over (é»˜è®¤)</button>
                <button onclick="showCompositeMode('multiply')">multiply (æ­£ç‰‡å åº•)</button>
                <button onclick="showCompositeMode('screen')">screen (æ»¤è‰²)</button>
                <button onclick="showCompositeMode('overlay')">overlay (å åŠ )</button>
                <button onclick="showCompositeMode('xor')">xor (å¼‚æˆ–)</button>
                <button onclick="showAllComposites()">ğŸ“Š æ˜¾ç¤ºæ‰€æœ‰æ¨¡å¼</button>
            </div>
        </div>

        <!-- ç¤ºä¾‹4: é˜´å½±æ•ˆæœ -->
        <div class="example-section">
            <div class="example-title">4. é˜´å½±æ•ˆæœæ¼”ç¤º</div>
            <div class="description">
                <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>æ¼”ç¤ºå¦‚ä½•åˆ›å»ºå„ç§é˜´å½±æ•ˆæœã€‚<br>
                <strong>æŠ€æœ¯è¦ç‚¹ï¼š</strong>
                <span class="code-hint">shadowColor</span>ã€
                <span class="code-hint">shadowBlur</span>ã€
                <span class="code-hint">shadowOffsetX/Y</span>
            </div>
            
            <canvas id="shadowCanvas" width="600" height="250"></canvas>
            
            <div class="controls">
                <div class="slider-control">
                    <label>é˜´å½±æ¨¡ç³Š:</label>
                    <input type="range" id="shadowBlur" min="0" max="50" value="10" oninput="updateShadows()">
                    <span id="shadowBlurValue">10</span>
                </div>
                <div class="slider-control">
                    <label>é˜´å½±åç§»X:</label>
                    <input type="range" id="shadowOffsetX" min="-30" max="30" value="5" oninput="updateShadows()">
                    <span id="shadowOffsetXValue">5</span>
                </div>
                <div class="slider-control">
                    <label>é˜´å½±åç§»Y:</label>
                    <input type="range" id="shadowOffsetY" min="-30" max="30" value="5" oninput="updateShadows()">
                    <span id="shadowOffsetYValue">5</span>
                </div>
                <button onclick="demoShadowEffects()">ğŸ¨ é¢„è®¾æ•ˆæœæ¼”ç¤º</button>
            </div>
        </div>
    </div>

    <script>
        // çŠ¶æ€ç®¡ç†æ¼”ç¤º
        function demonstrateState() {
            const canvas = document.getElementById('stateCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // åŸå§‹çŠ¶æ€ - çº¢è‰²çŸ©å½¢
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(50, 50, 100, 100);
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.fillText('åŸå§‹çŠ¶æ€', 60, 170);
            
            // ä¿å­˜çŠ¶æ€
            ctx.save();
            
            // ä¿®æ”¹çŠ¶æ€ - è“è‰²ã€æ—‹è½¬
            ctx.fillStyle = '#3498db';
            ctx.translate(250, 100);
            ctx.rotate(Math.PI / 6);
            ctx.fillRect(-50, -50, 100, 100);
            
            // æ¢å¤åŸç‚¹æ¥ç»˜åˆ¶æ–‡å­—
            ctx.restore();
            ctx.fillStyle = '#333';
            ctx.fillText('ä¿å­˜/æ¢å¤å', 210, 170);
            
            // å†æ¬¡ä¿å­˜çŠ¶æ€
            ctx.save();
            
            // å¤šé‡å˜æ¢
            ctx.fillStyle = '#2ecc71';
            ctx.translate(450, 100);
            ctx.scale(1.2, 0.8);
            ctx.rotate(-Math.PI / 8);
            ctx.fillRect(-50, -50, 100, 100);
            
            // æ¢å¤çŠ¶æ€
            ctx.restore();
            ctx.fillStyle = '#333';
            ctx.fillText('å¤šé‡å˜æ¢', 410, 170);
        }
        
        // æ›´æ–°å˜æ¢
        function updateTransforms() {
            const canvas = document.getElementById('transformCanvas');
            const ctx = canvas.getContext('2d');
            
            // è·å–æ§åˆ¶å€¼
            const translateX = parseInt(document.getElementById('translateX').value);
            const translateY = parseInt(document.getElementById('translateY').value);
            const rotation = parseInt(document.getElementById('rotation').value);
            const scale = parseFloat(document.getElementById('scale').value);
            
            // æ›´æ–°æ˜¾ç¤ºå€¼
            document.getElementById('translateXValue').textContent = translateX;
            document.getElementById('translateYValue').textContent = translateY;
            document.getElementById('rotationValue').textContent = rotation;
            document.getElementById('scaleValue').textContent = scale;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶åŸå§‹åæ ‡ç³»å‚è€ƒ
            ctx.save();
            drawCoordinateReference(ctx, 150, 150, 50);
            ctx.restore();
            
            // åº”ç”¨å˜æ¢å¹¶ç»˜åˆ¶
            ctx.save();
            ctx.translate(300 + translateX, 200 + translateY);
            ctx.rotate(rotation * Math.PI / 180);
            ctx.scale(scale, scale);
            
            // ç»˜åˆ¶å˜æ¢åçš„å›¾å½¢
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(-25, -25, 50, 50);
            
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.arc(0, 0, 30, 0, 2 * Math.PI);
            ctx.stroke();
            
            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(-40, 0);
            ctx.lineTo(40, 0);
            ctx.moveTo(0, -40);
            ctx.lineTo(0, 40);
            ctx.stroke();
            
            ctx.restore();
        }
        
        // ç»˜åˆ¶åæ ‡å‚è€ƒ
        function drawCoordinateReference(ctx, x, y, size) {
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            
            ctx.beginPath();
            ctx.moveTo(x - size, y);
            ctx.lineTo(x + size, y);
            ctx.moveTo(x, y - size);
            ctx.lineTo(x, y + size);
            ctx.stroke();
            
            ctx.setLineDash([]);
            ctx.fillStyle = '#999';
            ctx.font = '12px Arial';
            ctx.fillText('å‚è€ƒåŸç‚¹', x - 30, y - 60);
        }
        
        // é‡ç½®å˜æ¢
        function resetTransforms() {
            document.getElementById('translateX').value = '0';
            document.getElementById('translateY').value = '0';
            document.getElementById('rotation').value = '0';
            document.getElementById('scale').value = '1';
            updateTransforms();
        }
        
        // åŠ¨ç”»å˜æ¢
        function animateTransforms() {
            let frame = 0;
            const maxFrames = 120;
            
            function animate() {
                if (frame >= maxFrames) return;
                
                const progress = frame / maxFrames;
                const angle = progress * 720; // ä¸¤åœˆ
                const scaleValue = 1 + 0.5 * Math.sin(progress * Math.PI * 4);
                
                document.getElementById('rotation').value = angle % 360;
                document.getElementById('scale').value = scaleValue.toFixed(1);
                document.getElementById('translateX').value = Math.sin(progress * Math.PI * 2) * 100;
                document.getElementById('translateY').value = Math.cos(progress * Math.PI * 2) * 50;
                
                updateTransforms();
                
                frame++;
                requestAnimationFrame(animate);
            }
            
            animate();
        }
        
        // æ˜¾ç¤ºå¤åˆæ“ä½œæ¨¡å¼
        function showCompositeMode(mode) {
            const canvas = document.getElementById('compositeCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶èƒŒæ™¯å›¾å½¢ï¼ˆè“è‰²åœ†å½¢ï¼‰
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.arc(200, 150, 80, 0, 2 * Math.PI);
            ctx.fill();
            
            // è®¾ç½®å¤åˆæ“ä½œæ¨¡å¼
            ctx.globalCompositeOperation = mode;
            
            // ç»˜åˆ¶å‰æ™¯å›¾å½¢ï¼ˆçº¢è‰²çŸ©å½¢ï¼‰
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(160, 110, 160, 80);
            
            // é‡ç½®å¤åˆæ“ä½œ
            ctx.globalCompositeOperation = 'source-over';
            
            // æ·»åŠ æ ‡ç­¾
            ctx.fillStyle = '#333';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`å¤åˆæ¨¡å¼: ${mode}`, 240, 50);
            
            // æ·»åŠ è¯´æ˜æ–‡å­—
            ctx.font = '12px Arial';
            ctx.fillText('è“è‰²åœ†å½¢ï¼ˆèƒŒæ™¯ï¼‰ + çº¢è‰²çŸ©å½¢ï¼ˆå‰æ™¯ï¼‰', 240, 280);
        }
        
        // æ˜¾ç¤ºæ‰€æœ‰å¤åˆæ¨¡å¼
        function showAllComposites() {
            const canvas = document.getElementById('compositeCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const modes = ['source-over', 'multiply', 'screen', 'overlay', 'darken', 'lighten'];
            const cols = 3;
            const rows = 2;
            const cellWidth = canvas.width / cols;
            const cellHeight = canvas.height / rows;
            
            modes.forEach((mode, index) => {
                const x = (index % cols) * cellWidth;
                const y = Math.floor(index / cols) * cellHeight;
                
                ctx.save();
                ctx.translate(x, y);
                
                // ç»˜åˆ¶èƒŒæ™¯å›¾å½¢
                ctx.fillStyle = '#3498db';
                ctx.beginPath();
                ctx.arc(cellWidth/2, cellHeight/2, 30, 0, 2 * Math.PI);
                ctx.fill();
                
                // è®¾ç½®å¤åˆæ¨¡å¼
                ctx.globalCompositeOperation = mode;
                
                // ç»˜åˆ¶å‰æ™¯å›¾å½¢
                ctx.fillStyle = '#e74c3c';
                ctx.fillRect(cellWidth/2 - 20, cellHeight/2 - 15, 40, 30);
                
                // é‡ç½®å¤åˆæ¨¡å¼
                ctx.globalCompositeOperation = 'source-over';
                
                // æ·»åŠ æ ‡ç­¾
                ctx.fillStyle = '#333';
                ctx.font = '10px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(mode, cellWidth/2, cellHeight - 10);
                
                ctx.restore();
            });
        }
        
        // æ›´æ–°é˜´å½±æ•ˆæœ
        function updateShadows() {
            const canvas = document.getElementById('shadowCanvas');
            const ctx = canvas.getContext('2d');
            
            const blur = parseInt(document.getElementById('shadowBlur').value);
            const offsetX = parseInt(document.getElementById('shadowOffsetX').value);
            const offsetY = parseInt(document.getElementById('shadowOffsetY').value);
            
            document.getElementById('shadowBlurValue').textContent = blur;
            document.getElementById('shadowOffsetXValue').textContent = offsetX;
            document.getElementById('shadowOffsetYValue').textContent = offsetY;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // è®¾ç½®é˜´å½±å±æ€§
            ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
            ctx.shadowBlur = blur;
            ctx.shadowOffsetX = offsetX;
            ctx.shadowOffsetY = offsetY;
            
            // ç»˜åˆ¶æœ‰é˜´å½±çš„å›¾å½¢
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(100, 50, 80, 80);
            
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.arc(250, 90, 40, 0, 2 * Math.PI);
            ctx.fill();
            
            ctx.fillStyle = '#2ecc71';
            ctx.font = 'bold 24px Arial';
            ctx.fillText('é˜´å½±æ–‡å­—', 350, 90);
            
            // æ¸…é™¤é˜´å½±è®¾ç½®
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
            
            // æ·»åŠ è¯´æ˜
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.fillText(`æ¨¡ç³Š: ${blur}, åç§»: (${offsetX}, ${offsetY})`, 50, 200);
        }
        
        // é˜´å½±æ•ˆæœæ¼”ç¤º
        function demoShadowEffects() {
            const effects = [
                { blur: 0, offsetX: 0, offsetY: 0 },
                { blur: 10, offsetX: 5, offsetY: 5 },
                { blur: 20, offsetX: 0, offsetY: 0 },
                { blur: 5, offsetX: -10, offsetY: -10 },
                { blur: 15, offsetX: 10, offsetY: -5 }
            ];
            
            let index = 0;
            function nextEffect() {
                if (index >= effects.length) return;
                
                const effect = effects[index];
                document.getElementById('shadowBlur').value = effect.blur;
                document.getElementById('shadowOffsetX').value = effect.offsetX;
                document.getElementById('shadowOffsetY').value = effect.offsetY;
                
                updateShadows();
                
                index++;
                if (index < effects.length) {
                    setTimeout(nextEffect, 1500);
                }
            }
            
            nextEffect();
        }
        
        // æ¸…é™¤ç”»å¸ƒ
        function clearCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', function() {
            demonstrateState();
            updateTransforms();
            showCompositeMode('source-over');
            updateShadows();
        });
    </script>
</body>
</html> 