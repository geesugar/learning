# é¡¹ç›®ç»“æ„ä¸ç”Ÿå‘½å‘¨æœŸ

## ğŸ“– æ¦‚è¿°

æ·±å…¥ç†è§£iOSé¡¹ç›®çš„æ–‡ä»¶ç»“æ„ã€åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸå’Œè§†å›¾æ§åˆ¶å™¨ç”Ÿå‘½å‘¨æœŸæ˜¯iOSå¼€å‘çš„åŸºç¡€ã€‚æœ¬ç« å°†è¯¦ç»†è§£æè¿™äº›æ ¸å¿ƒæ¦‚å¿µï¼Œå¸®ä½ æ„å»ºæ‰å®çš„iOSå¼€å‘åŸºç¡€ã€‚

## ğŸ¯ å­¦ä¹ ç›®æ ‡

- ç†è§£iOSé¡¹ç›®çš„å®Œæ•´æ–‡ä»¶ç»“æ„
- æŒæ¡åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µ
- ç†Ÿæ‚‰è§†å›¾æ§åˆ¶å™¨çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
- äº†è§£AppDelegateå’ŒSceneDelegateçš„ä½œç”¨
- æŒæ¡Info.plisté…ç½®æ–‡ä»¶çš„ä½¿ç”¨
- å­¦ä¼šç®¡ç†åº”ç”¨èµ„æºå’ŒBundle

## ğŸ“ iOSé¡¹ç›®ç»“æ„è¯¦è§£

### æ ‡å‡†é¡¹ç›®ç»“æ„

```
MyiOSApp/
â”œâ”€â”€ MyiOSApp/                       # ä¸»åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ AppDelegate.swift          # åº”ç”¨å§”æ‰˜
â”‚   â”œâ”€â”€ SceneDelegate.swift        # åœºæ™¯å§”æ‰˜ (iOS 13+)
â”‚   â”œâ”€â”€ ContentView.swift          # ä¸»å†…å®¹è§†å›¾
â”‚   â”œâ”€â”€ ViewController.swift       # è§†å›¾æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ Main.storyboard           # ä¸»æ•…äº‹æ¿
â”‚   â”œâ”€â”€ LaunchScreen.storyboard   # å¯åŠ¨å±å¹•
â”‚   â”œâ”€â”€ Assets.xcassets           # èµ„æºç›®å½•
â”‚   â”œâ”€â”€ Info.plist               # åº”ç”¨é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ MyiOSApp.entitlements    # æƒé™é…ç½®æ–‡ä»¶
â”œâ”€â”€ MyiOSAppTests/                 # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ MyiOSAppTests.swift
â”‚   â””â”€â”€ Info.plist
â”œâ”€â”€ MyiOSAppUITests/              # UIæµ‹è¯•
â”‚   â”œâ”€â”€ MyiOSAppUITests.swift
â”‚   â”œâ”€â”€ MyiOSAppUITestsLaunchTests.swift
â”‚   â””â”€â”€ Info.plist
â”œâ”€â”€ Products/                      # ç¼–è¯‘äº§ç‰©
â”‚   â””â”€â”€ MyiOSApp.app
â””â”€â”€ MyiOSApp.xcodeproj            # Xcodeé¡¹ç›®æ–‡ä»¶
    â”œâ”€â”€ project.pbxproj           # é¡¹ç›®é…ç½®
    â”œâ”€â”€ project.xcworkspace/      # å·¥ä½œç©ºé—´
    â””â”€â”€ xcuserdata/              # ç”¨æˆ·æ•°æ®
```

### æ ¸å¿ƒæ–‡ä»¶è§£æ

#### 1. AppDelegate.swift

```swift
import UIKit

@main
class AppDelegate: UIResponder, UIApplicationDelegate {
    
    // åº”ç”¨å¯åŠ¨å®Œæˆ
    func application(_ application: UIApplication, 
                    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        
        // åº”ç”¨å¯åŠ¨æ—¶çš„åˆå§‹åŒ–å·¥ä½œ
        print("åº”ç”¨å¯åŠ¨å®Œæˆ")
        
        // è®¾ç½®å…¨å±€å¤–è§‚
        setupGlobalAppearance()
        
        // æ³¨å†Œæ¨é€é€šçŸ¥
        registerForPushNotifications()
        
        // åˆå§‹åŒ–ç¬¬ä¸‰æ–¹SDK
        initializeThirdPartySDKs()
        
        return true
    }
    
    // iOS 13+ åœºæ™¯é…ç½®
    func application(_ application: UIApplication, 
                    configurationForConnecting connectingSceneSession: UISceneSession, 
                    options: UIScene.ConnectionOptions) -> UISceneConfiguration {
        
        return UISceneConfiguration(name: "Default Configuration", 
                                   sessionRole: connectingSceneSession.role)
    }
    
    // åœºæ™¯æ–­å¼€è¿æ¥
    func application(_ application: UIApplication, 
                    didDiscardSceneSessions sceneSessions: Set<UISceneSession>) {
        // æ¸…ç†è¢«ä¸¢å¼ƒçš„åœºæ™¯èµ„æº
    }
    
    // MARK: - ç§æœ‰æ–¹æ³•
    
    private func setupGlobalAppearance() {
        // è®¾ç½®å¯¼èˆªæ å¤–è§‚
        let appearance = UINavigationBarAppearance()
        appearance.configureWithOpaqueBackground()
        appearance.backgroundColor = .systemBlue
        appearance.titleTextAttributes = [.foregroundColor: UIColor.white]
        
        UINavigationBar.appearance().standardAppearance = appearance
        UINavigationBar.appearance().scrollEdgeAppearance = appearance
    }
    
    private func registerForPushNotifications() {
        UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .badge, .sound]) { granted, error in
            print("æ¨é€é€šçŸ¥æƒé™: \(granted)")
        }
    }
    
    private func initializeThirdPartySDKs() {
        // åˆå§‹åŒ–Firebaseã€å‹ç›Ÿç­‰ç¬¬ä¸‰æ–¹SDK
        // FirebaseApp.configure()
        // UMConfigure.initWithAppkey("YOUR_APP_KEY")
    }
}
```

#### 2. SceneDelegate.swift (iOS 13+)

```swift
import UIKit

class SceneDelegate: UIResponder, UIWindowSceneDelegate {
    
    var window: UIWindow?
    
    // åœºæ™¯è¿æ¥
    func scene(_ scene: UIScene, willConnectTo session: UISceneSession, 
              options connectionOptions: UIScene.ConnectionOptions) {
        
        guard let windowScene = (scene as? UIWindowScene) else { return }
        
        // è®¾ç½®ä¸»çª—å£
        window = UIWindow(windowScene: windowScene)
        
        // ç¨‹åºåŒ–è®¾ç½®æ ¹è§†å›¾æ§åˆ¶å™¨ï¼ˆå¯é€‰ï¼‰
        // let mainViewController = ViewController()
        // let navigationController = UINavigationController(rootViewController: mainViewController)
        // window?.rootViewController = navigationController
        
        window?.makeKeyAndVisible()
        
        print("åœºæ™¯è¿æ¥å®Œæˆ")
    }
    
    // åœºæ™¯æ–­å¼€è¿æ¥
    func sceneDidDisconnect(_ scene: UIScene) {
        print("åœºæ™¯æ–­å¼€è¿æ¥")
        // æ¸…ç†èµ„æºï¼Œä¿å­˜æ•°æ®
    }
    
    // åœºæ™¯å˜ä¸ºæ´»è·ƒçŠ¶æ€
    func sceneDidBecomeActive(_ scene: UIScene) {
        print("åœºæ™¯å˜ä¸ºæ´»è·ƒçŠ¶æ€")
        // æ¢å¤æš‚åœçš„ä»»åŠ¡
        resumePausedTasks()
    }
    
    // åœºæ™¯å°†è¦å˜ä¸ºéæ´»è·ƒçŠ¶æ€
    func sceneWillResignActive(_ scene: UIScene) {
        print("åœºæ™¯å°†è¦å˜ä¸ºéæ´»è·ƒçŠ¶æ€")
        // æš‚åœæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡
        pauseOngoingTasks()
    }
    
    // åœºæ™¯è¿›å…¥å‰å°
    func sceneWillEnterForeground(_ scene: UIScene) {
        print("åœºæ™¯è¿›å…¥å‰å°")
        // æ›´æ–°UIï¼Œåˆ·æ–°æ•°æ®
        refreshData()
    }
    
    // åœºæ™¯è¿›å…¥åå°
    func sceneDidEnterBackground(_ scene: UIScene) {
        print("åœºæ™¯è¿›å…¥åå°")
        // ä¿å­˜æ•°æ®ï¼Œé‡Šæ”¾èµ„æº
        saveApplicationData()
    }
    
    // MARK: - ç§æœ‰æ–¹æ³•
    
    private func resumePausedTasks() {
        // æ¢å¤å®šæ—¶å™¨ã€åŠ¨ç”»ç­‰
    }
    
    private func pauseOngoingTasks() {
        // æš‚åœå®šæ—¶å™¨ã€åŠ¨ç”»ç­‰
    }
    
    private func refreshData() {
        // åˆ·æ–°ç½‘ç»œæ•°æ®
        NotificationCenter.default.post(name: .applicationWillEnterForeground, object: nil)
    }
    
    private func saveApplicationData() {
        // ä¿å­˜ç”¨æˆ·æ•°æ®
        UserDefaults.standard.synchronize()
    }
}

// MARK: - é€šçŸ¥æ‰©å±•
extension Notification.Name {
    static let applicationWillEnterForeground = Notification.Name("applicationWillEnterForeground")
}
```

#### 3. Info.plist é…ç½®è¯¦è§£

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <!-- åº”ç”¨åŸºæœ¬ä¿¡æ¯ -->
    <key>CFBundleDisplayName</key>
    <string>æˆ‘çš„åº”ç”¨</string>
    
    <key>CFBundleIdentifier</key>
    <string>com.company.myapp</string>
    
    <key>CFBundleShortVersionString</key>
    <string>1.0.0</string>
    
    <key>CFBundleVersion</key>
    <string>1</string>
    
    <!-- æ”¯æŒçš„è®¾å¤‡ç±»å‹ -->
    <key>UIDeviceFamily</key>
    <array>
        <integer>1</integer> <!-- iPhone -->
        <integer>2</integer> <!-- iPad -->
    </array>
    
    <!-- æ”¯æŒçš„iOSç‰ˆæœ¬ -->
    <key>MinimumOSVersion</key>
    <string>14.0</string>
    
    <!-- åº”ç”¨å›¾æ ‡ -->
    <key>CFBundleIcons</key>
    <dict>
        <key>CFBundlePrimaryIcon</key>
        <dict>
            <key>CFBundleIconFiles</key>
            <array>
                <string>AppIcon</string>
            </array>
        </dict>
    </dict>
    
    <!-- å¯åŠ¨ç•Œé¢ -->
    <key>UILaunchStoryboardName</key>
    <string>LaunchScreen</string>
    
    <key>UIMainStoryboardFile</key>
    <string>Main</string>
    
    <!-- çŠ¶æ€æ æ ·å¼ -->
    <key>UIStatusBarStyle</key>
    <string>UIStatusBarStyleDefault</string>
    
    <!-- æƒé™æè¿° -->
    <key>NSCameraUsageDescription</key>
    <string>æ­¤åº”ç”¨éœ€è¦è®¿é—®ç›¸æœºä»¥æ‹æ‘„ç…§ç‰‡</string>
    
    <key>NSPhotoLibraryUsageDescription</key>
    <string>æ­¤åº”ç”¨éœ€è¦è®¿é—®ç›¸å†Œä»¥é€‰æ‹©ç…§ç‰‡</string>
    
    <key>NSLocationWhenInUseUsageDescription</key>
    <string>æ­¤åº”ç”¨éœ€è¦è·å–ä½ç½®ä¿¡æ¯ä»¥æä¾›åŸºäºä½ç½®çš„æœåŠ¡</string>
    
    <!-- ç½‘ç»œå®‰å…¨é…ç½® -->
    <key>NSAppTransportSecurity</key>
    <dict>
        <key>NSAllowsArbitraryLoads</key>
        <false/>
        <key>NSExceptionDomains</key>
        <dict>
            <key>example.com</key>
            <dict>
                <key>NSExceptionAllowsInsecureHTTPLoads</key>
                <true/>
            </dict>
        </dict>
    </dict>
    
    <!-- æ”¯æŒçš„å±å¹•æ–¹å‘ -->
    <key>UISupportedInterfaceOrientations</key>
    <array>
        <string>UIInterfaceOrientationPortrait</string>
        <string>UIInterfaceOrientationLandscapeLeft</string>
        <string>UIInterfaceOrientationLandscapeRight</string>
    </array>
    
    <!-- iPadä¸“ç”¨è®¾ç½® -->
    <key>UISupportedInterfaceOrientations~ipad</key>
    <array>
        <string>UIInterfaceOrientationPortrait</string>
        <string>UIInterfaceOrientationPortraitUpsideDown</string>
        <string>UIInterfaceOrientationLandscapeLeft</string>
        <string>UIInterfaceOrientationLandscapeRight</string>
    </array>
</dict>
</plist>
```

## ğŸ”„ åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸ

### iOS 12åŠä¹‹å‰ç‰ˆæœ¬

```swift
// AppDelegateä¸­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•

class AppDelegate: UIResponder, UIApplicationDelegate {
    
    var window: UIWindow?
    
    // 1. åº”ç”¨å¯åŠ¨å®Œæˆ
    func application(_ application: UIApplication, 
                    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        print("1. åº”ç”¨å¯åŠ¨å®Œæˆ")
        return true
    }
    
    // 2. åº”ç”¨å˜ä¸ºæ´»è·ƒçŠ¶æ€
    func applicationDidBecomeActive(_ application: UIApplication) {
        print("2. åº”ç”¨å˜ä¸ºæ´»è·ƒçŠ¶æ€")
        // æ¢å¤æš‚åœçš„ä»»åŠ¡ï¼Œåˆ·æ–°UI
    }
    
    // 3. åº”ç”¨å°†è¦å˜ä¸ºéæ´»è·ƒçŠ¶æ€
    func applicationWillResignActive(_ application: UIApplication) {
        print("3. åº”ç”¨å°†è¦å˜ä¸ºéæ´»è·ƒçŠ¶æ€")
        // æš‚åœæ¸¸æˆï¼Œä¿å­˜æ•°æ®
    }
    
    // 4. åº”ç”¨è¿›å…¥åå°
    func applicationDidEnterBackground(_ application: UIApplication) {
        print("4. åº”ç”¨è¿›å…¥åå°")
        // ä¿å­˜ç”¨æˆ·æ•°æ®ï¼Œé‡Šæ”¾å…±äº«èµ„æº
        
        // ç”³è¯·åå°æ‰§è¡Œæ—¶é—´
        let backgroundTask = application.beginBackgroundTask {
            // åå°ä»»åŠ¡è¶…æ—¶å¤„ç†
        }
        
        DispatchQueue.global().async {
            // æ‰§è¡Œåå°ä»»åŠ¡
            self.saveUserData()
            
            application.endBackgroundTask(backgroundTask)
        }
    }
    
    // 5. åº”ç”¨å°†è¦è¿›å…¥å‰å°
    func applicationWillEnterForeground(_ application: UIApplication) {
        print("5. åº”ç”¨å°†è¦è¿›å…¥å‰å°")
        // åˆ·æ–°æ•°æ®ï¼Œæ›´æ–°UI
    }
    
    // 6. åº”ç”¨å°†è¦ç»ˆæ­¢
    func applicationWillTerminate(_ application: UIApplication) {
        print("6. åº”ç”¨å°†è¦ç»ˆæ­¢")
        // ä¿å­˜æ•°æ®ï¼Œæ¸…ç†èµ„æº
    }
    
    private func saveUserData() {
        // ä¿å­˜ç”¨æˆ·æ•°æ®çš„å®ç°
    }
}
```

### iOS 13+ å¤šåœºæ™¯æ”¯æŒ

```swift
// SceneDelegateä¸­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•

class SceneDelegate: UIResponder, UIWindowSceneDelegate {
    
    var window: UIWindow?
    
    // åœºæ™¯ç”Ÿå‘½å‘¨æœŸæµç¨‹ï¼š
    // willConnectTo â†’ willEnterForeground â†’ didBecomeActive
    
    func scene(_ scene: UIScene, willConnectTo session: UISceneSession, 
              options connectionOptions: UIScene.ConnectionOptions) {
        print("åœºæ™¯è¿æ¥: \(session.persistentIdentifier)")
    }
    
    func sceneWillEnterForeground(_ scene: UIScene) {
        print("åœºæ™¯å°†è¦è¿›å…¥å‰å°")
        // åˆ·æ–°UIæ•°æ®
        refreshApplicationData()
    }
    
    func sceneDidBecomeActive(_ scene: UIScene) {
        print("åœºæ™¯å˜ä¸ºæ´»è·ƒ")
        // å¼€å§‹æˆ–æ¢å¤ä»»åŠ¡
        startLocationUpdates()
        resumeNetworkOperations()
    }
    
    func sceneWillResignActive(_ scene: UIScene) {
        print("åœºæ™¯å°†è¦å¤±å»æ´»è·ƒçŠ¶æ€")
        // æš‚åœä»»åŠ¡
        pauseLocationUpdates()
        pauseTimers()
    }
    
    func sceneDidEnterBackground(_ scene: UIScene) {
        print("åœºæ™¯è¿›å…¥åå°")
        // ä¿å­˜æ•°æ®
        saveApplicationState()
    }
    
    func sceneDidDisconnect(_ scene: UIScene) {
        print("åœºæ™¯æ–­å¼€è¿æ¥")
        // æ¸…ç†åœºæ™¯ç‰¹å®šçš„èµ„æº
        cleanupSceneResources()
    }
    
    // MARK: - ç§æœ‰æ–¹æ³•
    
    private func refreshApplicationData() {
        // åˆ·æ–°ç½‘ç»œæ•°æ®
    }
    
    private func startLocationUpdates() {
        // å¼€å§‹ä½ç½®æ›´æ–°
    }
    
    private func resumeNetworkOperations() {
        // æ¢å¤ç½‘ç»œæ“ä½œ
    }
    
    private func pauseLocationUpdates() {
        // æš‚åœä½ç½®æ›´æ–°
    }
    
    private func pauseTimers() {
        // æš‚åœå®šæ—¶å™¨
    }
    
    private func saveApplicationState() {
        // ä¿å­˜åº”ç”¨çŠ¶æ€
        let encoder = JSONEncoder()
        if let data = try? encoder.encode(ApplicationState.current) {
            UserDefaults.standard.set(data, forKey: "ApplicationState")
        }
    }
    
    private func cleanupSceneResources() {
        // æ¸…ç†åœºæ™¯èµ„æº
    }
}

// åº”ç”¨çŠ¶æ€æ¨¡å‹
struct ApplicationState: Codable {
    let currentViewIndex: Int
    let userPreferences: [String: String]
    let lastUpdateTime: Date
    
    static var current: ApplicationState {
        // è¿”å›å½“å‰åº”ç”¨çŠ¶æ€
        return ApplicationState(
            currentViewIndex: 0,
            userPreferences: [:],
            lastUpdateTime: Date()
        )
    }
}
```

### ç”Ÿå‘½å‘¨æœŸçŠ¶æ€å›¾

```
åº”ç”¨å¯åŠ¨æµç¨‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Not Running   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ å¯åŠ¨åº”ç”¨
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Inactive     â”‚ â† ç”µè¯æ¥ç”µã€æ§åˆ¶ä¸­å¿ƒç­‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ è¿›å…¥å‰å°
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Active      â”‚ â† æ­£å¸¸ä½¿ç”¨çŠ¶æ€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ æŒ‰Homeé”®/åˆ‡æ¢åº”ç”¨
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Background    â”‚ â† åå°æ‰§è¡Œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ ç³»ç»Ÿå†…å­˜ä¸è¶³
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Suspended     â”‚ â† æŒ‚èµ·çŠ¶æ€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ ç³»ç»Ÿç»ˆæ­¢
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Not Running   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¬ è§†å›¾æ§åˆ¶å™¨ç”Ÿå‘½å‘¨æœŸ

### æ ¸å¿ƒç”Ÿå‘½å‘¨æœŸæ–¹æ³•

```swift
class ViewController: UIViewController {
    
    // MARK: - ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
    
    // 1. è§†å›¾åŠ è½½åˆ°å†…å­˜
    override func loadView() {
        print("1. loadView - åˆ›å»ºè§†å›¾")
        super.loadView()
        
        // ä»…åœ¨ç¨‹åºåŒ–åˆ›å»ºè§†å›¾æ—¶é‡å†™æ­¤æ–¹æ³•
        // ä¸è¦è°ƒç”¨super.loadView()å¦‚æœå®Œå…¨è‡ªå®šä¹‰è§†å›¾
    }
    
    // 2. è§†å›¾åŠ è½½å®Œæˆ
    override func viewDidLoad() {
        print("2. viewDidLoad - è§†å›¾åŠ è½½å®Œæˆ")
        super.viewDidLoad()
        
        // ä¸€æ¬¡æ€§è®¾ç½®å·¥ä½œ
        setupUI()
        setupConstraints()
        setupNotifications()
        loadInitialData()
    }
    
    // 3. è§†å›¾å°†è¦å‡ºç°
    override func viewWillAppear(_ animated: Bool) {
        print("3. viewWillAppear - è§†å›¾å°†è¦å‡ºç°")
        super.viewWillAppear(animated)
        
        // æ¯æ¬¡è§†å›¾å‡ºç°å‰éƒ½ä¼šè°ƒç”¨
        refreshData()
        updateNavigationBar()
        registerKeyboardNotifications()
    }
    
    // 4. è§†å›¾å·²ç»å‡ºç°
    override func viewDidAppear(_ animated: Bool) {
        print("4. viewDidAppear - è§†å›¾å·²ç»å‡ºç°")
        super.viewDidAppear(animated)
        
        // è§†å›¾å®Œå…¨æ˜¾ç¤ºåçš„æ“ä½œ
        startLocationTracking()
        beginPeriodicUpdates()
        trackScreenView() // ç»Ÿè®¡é¡µé¢è®¿é—®
    }
    
    // 5. è§†å›¾å°†è¦æ¶ˆå¤±
    override func viewWillDisappear(_ animated: Bool) {
        print("5. viewWillDisappear - è§†å›¾å°†è¦æ¶ˆå¤±")
        super.viewWillDisappear(animated)
        
        // è§†å›¾å³å°†æ¶ˆå¤±æ—¶çš„æ¸…ç†
        saveCurrentState()
        validateUserInput()
    }
    
    // 6. è§†å›¾å·²ç»æ¶ˆå¤±
    override func viewDidDisappear(_ animated: Bool) {
        print("6. viewDidDisappear - è§†å›¾å·²ç»æ¶ˆå¤±")
        super.viewDidDisappear(animated)
        
        // è§†å›¾å®Œå…¨æ¶ˆå¤±åçš„æ¸…ç†
        stopLocationTracking()
        cancelNetworkRequests()
        removeKeyboardNotifications()
    }
    
    // 7. å†…å­˜è­¦å‘Š
    override func didReceiveMemoryWarning() {
        print("7. didReceiveMemoryWarning - æ”¶åˆ°å†…å­˜è­¦å‘Š")
        super.didReceiveMemoryWarning()
        
        // æ¸…ç†éå¿…è¦èµ„æº
        clearImageCache()
        releaseHeavyResources()
    }
    
    // 8. è§†å›¾å³å°†ä»å†…å­˜ä¸­ç§»é™¤
    deinit {
        print("8. deinit - è§†å›¾æ§åˆ¶å™¨å³å°†é”€æ¯")
        
        // æœ€ç»ˆæ¸…ç†å·¥ä½œ
        removeAllObservers()
        invalidateTimers()
    }
    
    // MARK: - è®¾ç½®æ–¹æ³•
    
    private func setupUI() {
        view.backgroundColor = .systemBackground
        
        // è®¾ç½®å¯¼èˆªæ 
        navigationItem.title = "ç¤ºä¾‹é¡µé¢"
        navigationItem.rightBarButtonItem = UIBarButtonItem(
            barButtonSystemItem: .add,
            target: self,
            action: #selector(addButtonTapped)
        )
    }
    
    private func setupConstraints() {
        // è®¾ç½®è‡ªåŠ¨å¸ƒå±€çº¦æŸ
    }
    
    private func setupNotifications() {
        NotificationCenter.default.addObserver(
            self,
            selector: #selector(applicationWillEnterForeground),
            name: UIApplication.willEnterForegroundNotification,
            object: nil
        )
    }
    
    private func loadInitialData() {
        // åŠ è½½åˆå§‹æ•°æ®
    }
    
    // MARK: - æ•°æ®ç®¡ç†
    
    private func refreshData() {
        // åˆ·æ–°æ•°æ®
    }
    
    private func saveCurrentState() {
        // ä¿å­˜å½“å‰çŠ¶æ€
    }
    
    // MARK: - é€šçŸ¥å¤„ç†
    
    @objc private func applicationWillEnterForeground() {
        // åº”ç”¨å³å°†è¿›å…¥å‰å°æ—¶çš„å¤„ç†
        refreshData()
    }
    
    @objc private func addButtonTapped() {
        // æ·»åŠ æŒ‰é’®ç‚¹å‡»äº‹ä»¶
    }
    
    // MARK: - èµ„æºç®¡ç†
    
    private func clearImageCache() {
        // æ¸…ç†å›¾ç‰‡ç¼“å­˜
    }
    
    private func releaseHeavyResources() {
        // é‡Šæ”¾é‡å‹èµ„æº
    }
    
    private func removeAllObservers() {
        NotificationCenter.default.removeObserver(self)
    }
    
    private func invalidateTimers() {
        // åœæ­¢æ‰€æœ‰å®šæ—¶å™¨
    }
}
```

### è§†å›¾æ§åˆ¶å™¨å®¹å™¨ç”Ÿå‘½å‘¨æœŸ

```swift
// è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨
class ContainerViewController: UIViewController {
    
    private var childViewControllers: [UIViewController] = []
    
    // æ·»åŠ å­è§†å›¾æ§åˆ¶å™¨
    func addChildViewController(_ childController: UIViewController) {
        // 1. æ·»åŠ ä¸ºå­æ§åˆ¶å™¨
        addChild(childController)
        
        // 2. æ·»åŠ å­è§†å›¾
        view.addSubview(childController.view)
        
        // 3. è®¾ç½®çº¦æŸ
        childController.view.translatesAutoresizingMaskIntoConstraints = false
        NSLayoutConstraint.activate([
            childController.view.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
            childController.view.leadingAnchor.constraint(equalTo: view.leadingAnchor),
            childController.view.trailingAnchor.constraint(equalTo: view.trailingAnchor),
            childController.view.bottomAnchor.constraint(equalTo: view.bottomAnchor)
        ])
        
        // 4. é€šçŸ¥å­æ§åˆ¶å™¨å·²ç§»åŠ¨åˆ°çˆ¶æ§åˆ¶å™¨
        childController.didMove(toParent: self)
        
        childViewControllers.append(childController)
    }
    
    // ç§»é™¤å­è§†å›¾æ§åˆ¶å™¨
    func removeChildViewController(_ childController: UIViewController) {
        // 1. é€šçŸ¥å­æ§åˆ¶å™¨å°†è¦ä»çˆ¶æ§åˆ¶å™¨ç§»é™¤
        childController.willMove(toParent: nil)
        
        // 2. ç§»é™¤å­è§†å›¾
        childController.view.removeFromSuperview()
        
        // 3. ä»çˆ¶æ§åˆ¶å™¨ç§»é™¤
        childController.removeFromParent()
        
        // 4. ä»æ•°ç»„ä¸­ç§»é™¤
        if let index = childViewControllers.firstIndex(of: childController) {
            childViewControllers.remove(at: index)
        }
    }
}
```

## ğŸ“± Sceneå’ŒWindowç®¡ç†

### å¤šçª—å£æ”¯æŒ (iPadOS)

```swift
// SceneDelegate.swift - æ”¯æŒå¤šçª—å£

class SceneDelegate: UIResponder, UIWindowSceneDelegate {
    
    var window: UIWindow?
    
    func scene(_ scene: UIScene, willConnectTo session: UISceneSession, 
              options connectionOptions: UIScene.ConnectionOptions) {
        
        guard let windowScene = (scene as? UIWindowScene) else { return }
        
        // é…ç½®çª—å£
        window = UIWindow(windowScene: windowScene)
        
        // æ ¹æ®åœºæ™¯é…ç½®è®¾ç½®ä¸åŒçš„æ ¹è§†å›¾æ§åˆ¶å™¨
        let storyboard = UIStoryboard(name: "Main", bundle: nil)
        
        if session.configuration.name == "Default Configuration" {
            // ä¸»çª—å£é…ç½®
            let mainViewController = storyboard.instantiateViewController(withIdentifier: "MainViewController")
            let navigationController = UINavigationController(rootViewController: mainViewController)
            window?.rootViewController = navigationController
        } else {
            // è¾…åŠ©çª—å£é…ç½®
            let secondaryViewController = storyboard.instantiateViewController(withIdentifier: "SecondaryViewController")
            window?.rootViewController = secondaryViewController
        }
        
        window?.makeKeyAndVisible()
        
        // å¤„ç†å¯åŠ¨å‚æ•°
        handleLaunchOptions(connectionOptions)
    }
    
    private func handleLaunchOptions(_ connectionOptions: UIScene.ConnectionOptions) {
        // å¤„ç†URLå¯åŠ¨
        if let urlContext = connectionOptions.urlContexts.first {
            handleURL(urlContext.url)
        }
        
        // å¤„ç†Shortcutå¯åŠ¨
        if let shortcutItem = connectionOptions.shortcutItem {
            handleShortcutItem(shortcutItem)
        }
        
        // å¤„ç†é€šçŸ¥å¯åŠ¨
        if let notificationResponse = connectionOptions.notificationResponse {
            handleNotificationResponse(notificationResponse)
        }
    }
    
    private func handleURL(_ url: URL) {
        // å¤„ç†URL schemeå¯åŠ¨
        print("é€šè¿‡URLå¯åŠ¨: \(url)")
    }
    
    private func handleShortcutItem(_ shortcutItem: UIApplicationShortcutItem) {
        // å¤„ç†3D Touchå¿«æ·æ–¹å¼
        print("å¿«æ·æ–¹å¼å¯åŠ¨: \(shortcutItem.type)")
    }
    
    private func handleNotificationResponse(_ response: UNNotificationResponse) {
        // å¤„ç†æ¨é€é€šçŸ¥å“åº”
        print("é€šçŸ¥å“åº”å¯åŠ¨: \(response.notification.request.identifier)")
    }
}

// AppDelegate.swift - åœºæ™¯é…ç½®

extension AppDelegate {
    
    // é…ç½®æ–°åœºæ™¯
    func application(_ application: UIApplication, 
                    configurationForConnecting connectingSceneSession: UISceneSession, 
                    options: UIScene.ConnectionOptions) -> UISceneConfiguration {
        
        let configuration = UISceneConfiguration(
            name: "Default Configuration",
            sessionRole: connectingSceneSession.role
        )
        
        configuration.delegateClass = SceneDelegate.self
        configuration.storyboard = UIStoryboard(name: "Main", bundle: nil)
        
        return configuration
    }
    
    // åœºæ™¯ä¼šè¯ä¸¢å¼ƒ
    func application(_ application: UIApplication, 
                    didDiscardSceneSessions sceneSessions: Set<UISceneSession>) {
        
        // æ¸…ç†ä¸¢å¼ƒçš„åœºæ™¯æ•°æ®
        for session in sceneSessions {
            print("ä¸¢å¼ƒåœºæ™¯ä¼šè¯: \(session.persistentIdentifier)")
            cleanupSessionData(session.persistentIdentifier)
        }
    }
    
    private func cleanupSessionData(_ sessionIdentifier: String) {
        // æ¸…ç†ç‰¹å®šä¼šè¯çš„æ•°æ®
        UserDefaults.standard.removeObject(forKey: "session_\(sessionIdentifier)")
    }
}
```

## ğŸ¯ å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šç”Ÿå‘½å‘¨æœŸæ—¥å¿—è®°å½•å™¨

```swift
// åˆ›å»ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸç›‘æ§çš„åŸºç±»
class LifecycleViewController: UIViewController {
    
    var lifecycleLogger = LifecycleLogger()
    
    override func viewDidLoad() {
        super.viewDidLoad()
        lifecycleLogger.log(.viewDidLoad, for: String(describing: type(of: self)))
    }
    
    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)
        lifecycleLogger.log(.viewWillAppear, for: String(describing: type(of: self)))
    }
    
    override func viewDidAppear(_ animated: Bool) {
        super.viewDidAppear(animated)
        lifecycleLogger.log(.viewDidAppear, for: String(describing: type(of: self)))
    }
    
    override func viewWillDisappear(_ animated: Bool) {
        super.viewWillDisappear(animated)
        lifecycleLogger.log(.viewWillDisappear, for: String(describing: type(of: self)))
    }
    
    override func viewDidDisappear(_ animated: Bool) {
        super.viewDidDisappear(animated)
        lifecycleLogger.log(.viewDidDisappear, for: String(describing: type(of: self)))
    }
    
    deinit {
        lifecycleLogger.log(.deinit, for: String(describing: type(of: self)))
    }
}

// ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æšä¸¾
enum LifecycleEvent: String, CaseIterable {
    case viewDidLoad
    case viewWillAppear
    case viewDidAppear
    case viewWillDisappear
    case viewDidDisappear
    case deinit
}

// ç”Ÿå‘½å‘¨æœŸè®°å½•å™¨
class LifecycleLogger {
    
    private var events: [(event: LifecycleEvent, controller: String, timestamp: Date)] = []
    
    func log(_ event: LifecycleEvent, for controller: String) {
        let logEntry = (event: event, controller: controller, timestamp: Date())
        events.append(logEntry)
        
        let formatter = DateFormatter()
        formatter.dateFormat = "HH:mm:ss.SSS"
        let timeString = formatter.string(from: logEntry.timestamp)
        
        print("[\(timeString)] \(controller): \(event.rawValue)")
    }
    
    func getEventHistory() -> [(event: LifecycleEvent, controller: String, timestamp: Date)] {
        return events
    }
    
    func clearHistory() {
        events.removeAll()
    }
}

// ä½¿ç”¨ç¤ºä¾‹
class FirstViewController: LifecycleViewController {
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        title = "ç¬¬ä¸€ä¸ªé¡µé¢"
        view.backgroundColor = .systemBlue
        
        // æ·»åŠ è·³è½¬æŒ‰é’®
        let nextButton = UIButton(type: .system)
        nextButton.setTitle("è·³è½¬åˆ°ç¬¬äºŒé¡µ", for: .normal)
        nextButton.addTarget(self, action: #selector(nextButtonTapped), for: .touchUpInside)
        
        view.addSubview(nextButton)
        nextButton.translatesAutoresizingMaskIntoConstraints = false
        NSLayoutConstraint.activate([
            nextButton.centerXAnchor.constraint(equalTo: view.centerXAnchor),
            nextButton.centerYAnchor.constraint(equalTo: view.centerYAnchor)
        ])
    }
    
    @objc private func nextButtonTapped() {
        let secondVC = SecondViewController()
        navigationController?.pushViewController(secondVC, animated: true)
    }
}

class SecondViewController: LifecycleViewController {
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        title = "ç¬¬äºŒä¸ªé¡µé¢"
        view.backgroundColor = .systemGreen
        
        // æ·»åŠ è¿”å›æŒ‰é’®
        let backButton = UIButton(type: .system)
        backButton.setTitle("è¿”å›", for: .normal)
        backButton.addTarget(self, action: #selector(backButtonTapped), for: .touchUpInside)
        
        view.addSubview(backButton)
        backButton.translatesAutoresizingMaskIntoConstraints = false
        NSLayoutConstraint.activate([
            backButton.centerXAnchor.constraint(equalTo: view.centerXAnchor),
            backButton.centerYAnchor.constraint(equalTo: view.centerYAnchor)
        ])
    }
    
    @objc private func backButtonTapped() {
        navigationController?.popViewController(animated: true)
    }
}
```

### ç»ƒä¹ 2ï¼šåº”ç”¨çŠ¶æ€ç®¡ç†å™¨

```swift
// åº”ç”¨çŠ¶æ€ç®¡ç†å™¨
class ApplicationStateManager {
    
    static let shared = ApplicationStateManager()
    private init() {}
    
    private var stateObservers: [ApplicationStateObserver] = []
    
    // æ·»åŠ çŠ¶æ€è§‚å¯Ÿè€…
    func addObserver(_ observer: ApplicationStateObserver) {
        stateObservers.append(observer)
    }
    
    // ç§»é™¤çŠ¶æ€è§‚å¯Ÿè€…
    func removeObserver(_ observer: ApplicationStateObserver) {
        stateObservers.removeAll { $0 === observer }
    }
    
    // é€šçŸ¥çŠ¶æ€å˜åŒ–
    func notifyStateChange(_ state: ApplicationState) {
        stateObservers.forEach { $0.applicationStateDidChange(state) }
    }
}

// åº”ç”¨çŠ¶æ€æšä¸¾
enum ApplicationState {
    case launching
    case active
    case inactive
    case background
    case terminating
}

// çŠ¶æ€è§‚å¯Ÿè€…åè®®
protocol ApplicationStateObserver: AnyObject {
    func applicationStateDidChange(_ state: ApplicationState)
}

// çŠ¶æ€æ„ŸçŸ¥è§†å›¾æ§åˆ¶å™¨
class StateAwareViewController: UIViewController, ApplicationStateObserver {
    
    private let stateLabel = UILabel()
    private let timestampLabel = UILabel()
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        setupUI()
        ApplicationStateManager.shared.addObserver(self)
    }
    
    deinit {
        ApplicationStateManager.shared.removeObserver(self)
    }
    
    private func setupUI() {
        view.backgroundColor = .systemBackground
        
        // çŠ¶æ€æ ‡ç­¾
        stateLabel.textAlignment = .center
        stateLabel.font = .systemFont(ofSize: 24, weight: .bold)
        stateLabel.text = "åº”ç”¨çŠ¶æ€: æœªçŸ¥"
        
        // æ—¶é—´æ ‡ç­¾
        timestampLabel.textAlignment = .center
        timestampLabel.font = .systemFont(ofSize: 16)
        timestampLabel.textColor = .secondaryLabel
        
        let stackView = UIStackView(arrangedSubviews: [stateLabel, timestampLabel])
        stackView.axis = .vertical
        stackView.spacing = 20
        stackView.translatesAutoresizingMaskIntoConstraints = false
        
        view.addSubview(stackView)
        
        NSLayoutConstraint.activate([
            stackView.centerXAnchor.constraint(equalTo: view.centerXAnchor),
            stackView.centerYAnchor.constraint(equalTo: view.centerYAnchor)
        ])
    }
    
    // MARK: - ApplicationStateObserver
    
    func applicationStateDidChange(_ state: ApplicationState) {
        DispatchQueue.main.async {
            self.updateUI(for: state)
        }
    }
    
    private func updateUI(for state: ApplicationState) {
        let stateText: String
        let backgroundColor: UIColor
        
        switch state {
        case .launching:
            stateText = "å¯åŠ¨ä¸­"
            backgroundColor = .systemYellow
        case .active:
            stateText = "æ´»è·ƒçŠ¶æ€"
            backgroundColor = .systemGreen
        case .inactive:
            stateText = "éæ´»è·ƒçŠ¶æ€"
            backgroundColor = .systemOrange
        case .background:
            stateText = "åå°çŠ¶æ€"
            backgroundColor = .systemBlue
        case .terminating:
            stateText = "å³å°†ç»ˆæ­¢"
            backgroundColor = .systemRed
        }
        
        stateLabel.text = "åº”ç”¨çŠ¶æ€: \(stateText)"
        view.backgroundColor = backgroundColor.withAlphaComponent(0.1)
        
        let formatter = DateFormatter()
        formatter.dateFormat = "HH:mm:ss"
        timestampLabel.text = "æ›´æ–°æ—¶é—´: \(formatter.string(from: Date()))"
    }
}

// åœ¨AppDelegateä¸­ä½¿ç”¨çŠ¶æ€ç®¡ç†å™¨
extension AppDelegate {
    
    func application(_ application: UIApplication, 
                    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        ApplicationStateManager.shared.notifyStateChange(.launching)
        return true
    }
    
    func applicationDidBecomeActive(_ application: UIApplication) {
        ApplicationStateManager.shared.notifyStateChange(.active)
    }
    
    func applicationWillResignActive(_ application: UIApplication) {
        ApplicationStateManager.shared.notifyStateChange(.inactive)
    }
    
    func applicationDidEnterBackground(_ application: UIApplication) {
        ApplicationStateManager.shared.notifyStateChange(.background)
    }
    
    func applicationWillTerminate(_ application: UIApplication) {
        ApplicationStateManager.shared.notifyStateChange(.terminating)
    }
}
```

## ğŸ“ å°ç»“

### é‡ç‚¹å›é¡¾

1. **é¡¹ç›®ç»“æ„**: ç†è§£iOSé¡¹ç›®çš„æ–‡ä»¶ç»„ç»‡å’Œå„æ–‡ä»¶çš„ä½œç”¨
2. **åº”ç”¨ç”Ÿå‘½å‘¨æœŸ**: æŒæ¡åº”ç”¨ä»å¯åŠ¨åˆ°ç»ˆæ­¢çš„å®Œæ•´æµç¨‹
3. **è§†å›¾æ§åˆ¶å™¨ç”Ÿå‘½å‘¨æœŸ**: ç†Ÿæ‚‰è§†å›¾åŠ è½½ã€æ˜¾ç¤ºã€éšè—ã€é”€æ¯çš„å„ä¸ªé˜¶æ®µ
4. **Sceneç®¡ç†**: äº†è§£iOS 13+çš„å¤šåœºæ™¯æ”¯æŒå’Œçª—å£ç®¡ç†
5. **èµ„æºç®¡ç†**: å­¦ä¼šåœ¨åˆé€‚çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ç®¡ç†èµ„æº

### æœ€ä½³å®è·µ

- **æ•°æ®åŠ è½½**: åœ¨`viewDidLoad`ä¸­è¿›è¡Œä¸€æ¬¡æ€§åˆå§‹åŒ–
- **UIåˆ·æ–°**: åœ¨`viewWillAppear`ä¸­åˆ·æ–°æ•°æ®å’ŒUI
- **èµ„æºæ¸…ç†**: åœ¨`viewDidDisappear`å’Œ`deinit`ä¸­åŠæ—¶æ¸…ç†èµ„æº
- **çŠ¶æ€ä¿å­˜**: åœ¨é€‚å½“çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ä¿å­˜åº”ç”¨çŠ¶æ€
- **å†…å­˜ç®¡ç†**: ç›‘å¬å†…å­˜è­¦å‘Šå¹¶åŠæ—¶é‡Šæ”¾éå¿…è¦èµ„æº

### å¸¸è§é™·é˜±

- åœ¨é”™è¯¯çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ‰§è¡Œæ“ä½œ
- å¿˜è®°ç§»é™¤è§‚å¯Ÿè€…å¯¼è‡´å†…å­˜æ³„æ¼
- è¿‡åº¦ä¾èµ–`viewDidLoad`è¿›è¡Œæ•°æ®åˆ·æ–°
- å¿½è§†å†…å­˜è­¦å‘Šçš„å¤„ç†
- ä¸æ­£ç¡®å¤„ç†å¤šåœºæ™¯ä¸‹çš„çŠ¶æ€ç®¡ç†

## ğŸ”„ ä¸‹ä¸€æ­¥

æŒæ¡äº†é¡¹ç›®ç»“æ„å’Œç”Ÿå‘½å‘¨æœŸåï¼Œæ¥ä¸‹æ¥å­¦ä¹ ï¼š

- **[ç•Œé¢è®¾è®¡åŸºç¡€](./03-ç•Œé¢è®¾è®¡åŸºç¡€.md)**: æ·±å…¥å­¦ä¹ Interface Builderå’ŒAuto Layout
- **[è§†å›¾ä¸è§†å›¾æ§åˆ¶å™¨](./04-è§†å›¾ä¸è§†å›¾æ§åˆ¶å™¨.md)**: ç†è§£è§†å›¾ç³»ç»Ÿå’ŒMVCæ¨¡å¼

**ä½ å·²ç»æŒæ¡äº†iOSå¼€å‘çš„æ ¸å¿ƒæ¶æ„çŸ¥è¯†ï¼** ğŸš€ 