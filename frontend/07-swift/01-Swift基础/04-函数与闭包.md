# Swiftå‡½æ•°ä¸é—­åŒ…

## ğŸ“– æ¦‚è¿°

å‡½æ•°æ˜¯Swiftç¼–ç¨‹çš„æ ¸å¿ƒæ„å»ºå—ï¼Œç”¨äºå°è£…ç‰¹å®šçš„åŠŸèƒ½ã€‚é—­åŒ…æ˜¯è‡ªåŒ…å«çš„å‡½æ•°ä»£ç å—ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ä¼ é€’å’Œä½¿ç”¨ã€‚æŒæ¡å‡½æ•°å’Œé—­åŒ…æ˜¯ç¼–å†™é«˜è´¨é‡Swiftä»£ç çš„å…³é”®ã€‚

## ğŸ¯ å­¦ä¹ ç›®æ ‡

- æŒæ¡å‡½æ•°çš„å®šä¹‰ã€è°ƒç”¨å’Œå‚æ•°ä¼ é€’
- ç†è§£å‡½æ•°çš„è¿”å›å€¼å’Œå¤šè¿”å›å€¼
- å­¦ä¼šä½¿ç”¨é—­åŒ…è¡¨è¾¾å¼å’Œè¯­æ³•ç®€åŒ–
- æŒæ¡é«˜é˜¶å‡½æ•°çš„ä½¿ç”¨
- ç†è§£é€ƒé€¸é—­åŒ…å’Œéé€ƒé€¸é—­åŒ…
- å­¦ä¼šå‡½æ•°å¼ç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µ

## ğŸ”§ å‡½æ•°åŸºç¡€

### å‡½æ•°å®šä¹‰å’Œè°ƒç”¨

```swift
// åŸºæœ¬å‡½æ•°å®šä¹‰
func sayHello() {
    print("Hello, World!")
}

// è°ƒç”¨å‡½æ•°
sayHello()  // è¾“å‡º: Hello, World!

// å¸¦å‚æ•°çš„å‡½æ•°
func greet(person: String) {
    print("Hello, \(person)!")
}

greet(person: "Alice")  // è¾“å‡º: Hello, Alice!

// å¸¦è¿”å›å€¼çš„å‡½æ•°
func add(a: Int, b: Int) -> Int {
    return a + b
}

let result = add(a: 5, b: 3)
print("ç»“æœ: \(result)")  // è¾“å‡º: ç»“æœ: 8
```

### å‚æ•°æ ‡ç­¾å’Œå‚æ•°åç§°

```swift
// å‚æ•°æ ‡ç­¾å’Œå‚æ•°åç§°ä¸åŒ
func greet(to person: String, from hometown: String) {
    print("Hello \(person)! æ¥è‡ª\(hometown)çš„é—®å€™ã€‚")
}

greet(to: "Bill", from: "åŒ—äº¬")

// å¿½ç•¥å‚æ•°æ ‡ç­¾
func someFunction(_ firstParameterName: Int, secondParameterName: Int) {
    print("ç¬¬ä¸€ä¸ªå‚æ•°: \(firstParameterName)")
    print("ç¬¬äºŒä¸ªå‚æ•°: \(secondParameterName)")
}

someFunction(1, secondParameterName: 2)

// é»˜è®¤å‚æ•°å€¼
func greetWithDefault(person: String, polite: Bool = true) {
    if polite {
        print("æ‚¨å¥½, \(person)!")
    } else {
        print("å—¨, \(person)!")
    }
}

greetWithDefault(person: "å¼ ä¸‰")      // ä½¿ç”¨é»˜è®¤å€¼true
greetWithDefault(person: "æå››", polite: false)  // æŒ‡å®šä¸ºfalse
```

### å¯å˜å‚æ•°

```swift
// å¯å˜å‚æ•°å‡½æ•°
func arithmeticMean(_ numbers: Double...) -> Double {
    var total: Double = 0
    for number in numbers {
        total += number
    }
    return total / Double(numbers.count)
}

let average1 = arithmeticMean(1, 2, 3, 4, 5)
print("å¹³å‡å€¼: \(average1)")  // è¾“å‡º: å¹³å‡å€¼: 3.0

let average2 = arithmeticMean(3.0, 8.25, 18.75)
print("å¹³å‡å€¼: \(average2)")  // è¾“å‡º: å¹³å‡å€¼: 10.0

// æ ¼å¼åŒ–è¾“å‡ºå‡½æ•°
func printMessage(title: String, messages: String...) {
    print("=== \(title) ===")
    for message in messages {
        print("- \(message)")
    }
}

printMessage(title: "é”™è¯¯ä¿¡æ¯", messages: "ç½‘ç»œè¿æ¥å¤±è´¥", "æœåŠ¡å™¨å“åº”è¶…æ—¶", "æ•°æ®è§£æé”™è¯¯")
```

### è¾“å…¥è¾“å‡ºå‚æ•°

```swift
// ä½¿ç”¨inoutå…³é”®å­—
func swapTwoInts(_ a: inout Int, _ b: inout Int) {
    let temporaryA = a
    a = b
    b = temporaryA
}

var someInt = 3
var anotherInt = 107
swapTwoInts(&someInt, &anotherInt)
print("someInt: \(someInt), anotherInt: \(anotherInt)")
// è¾“å‡º: someInt: 107, anotherInt: 3

// å®é™…åº”ç”¨ï¼šæ’åºå‡½æ•°
func sortArray(_ array: inout [Int], ascending: Bool = true) {
    array.sort { first, second in
        if ascending {
            return first < second
        } else {
            return first > second
        }
    }
}

var numbers = [5, 2, 8, 1, 9]
sortArray(&numbers)
print("å‡åº: \(numbers)")  // è¾“å‡º: å‡åº: [1, 2, 5, 8, 9]

sortArray(&numbers, ascending: false)
print("é™åº: \(numbers)")  // è¾“å‡º: é™åº: [9, 8, 5, 2, 1]
```

## ğŸ“¦ å‡½æ•°è¿”å›å€¼

### å•ä¸ªè¿”å›å€¼

```swift
// ç®€å•è¿”å›å€¼
func square(_ number: Int) -> Int {
    return number * number
}

// éšå¼è¿”å›ï¼ˆå•è¡¨è¾¾å¼å‡½æ•°ï¼‰
func cube(_ number: Int) -> Int {
    number * number * number  // çœç•¥returnå…³é”®å­—
}

print("3çš„å¹³æ–¹: \(square(3))")  // è¾“å‡º: 3çš„å¹³æ–¹: 9
print("3çš„ç«‹æ–¹: \(cube(3))")   // è¾“å‡º: 3çš„ç«‹æ–¹: 27
```

### å¤šé‡è¿”å›å€¼ï¼ˆå…ƒç»„ï¼‰

```swift
// è¿”å›å…ƒç»„
func minMax(array: [Int]) -> (min: Int, max: Int) {
    var currentMin = array[0]
    var currentMax = array[0]
    
    for value in array[1..<array.count] {
        if value < currentMin {
            currentMin = value
        } else if value > currentMax {
            currentMax = value
        }
    }
    return (currentMin, currentMax)
}

let bounds = minMax(array: [8, -6, 2, 109, 3, 71])
print("æœ€å°å€¼: \(bounds.min), æœ€å¤§å€¼: \(bounds.max)")
// è¾“å‡º: æœ€å°å€¼: -6, æœ€å¤§å€¼: 109

// åˆ†è§£å…ƒç»„
let (minimum, maximum) = minMax(array: [8, -6, 2, 109, 3, 71])
print("åˆ†åˆ«è·å– - æœ€å°å€¼: \(minimum), æœ€å¤§å€¼: \(maximum)")
```

### å¯é€‰è¿”å›å€¼

```swift
// è¿”å›å¯é€‰ç±»å‹
func minMaxSafe(array: [Int]) -> (min: Int, max: Int)? {
    if array.isEmpty { return nil }
    
    var currentMin = array[0]
    var currentMax = array[0]
    
    for value in array[1..<array.count] {
        if value < currentMin {
            currentMin = value
        } else if value > currentMax {
            currentMax = value
        }
    }
    return (currentMin, currentMax)
}

// å®‰å…¨ä½¿ç”¨
if let bounds = minMaxSafe(array: [8, -6, 2, 109, 3, 71]) {
    print("å®‰å…¨è·å– - æœ€å°å€¼: \(bounds.min), æœ€å¤§å€¼: \(bounds.max)")
} else {
    print("æ•°ç»„ä¸ºç©º")
}

// ç©ºæ•°ç»„æµ‹è¯•
if let bounds = minMaxSafe(array: []) {
    print("æœ€å°å€¼: \(bounds.min), æœ€å¤§å€¼: \(bounds.max)")
} else {
    print("æ•°ç»„ä¸ºç©ºï¼Œæ— æ³•è®¡ç®—")  // è¾“å‡ºè¿™è¡Œ
}
```

## ğŸ­ å‡½æ•°ç±»å‹

### å‡½æ•°ç±»å‹å˜é‡

```swift
// å®šä¹‰å‡½æ•°ç±»å‹
func addTwoInts(_ a: Int, _ b: Int) -> Int {
    return a + b
}

func multiplyTwoInts(_ a: Int, _ b: Int) -> Int {
    return a * b
}

// å‡½æ•°ç±»å‹å˜é‡
var mathFunction: (Int, Int) -> Int = addTwoInts
print("ç»“æœ: \(mathFunction(2, 3))")  // è¾“å‡º: ç»“æœ: 5

// æ”¹å˜å‡½æ•°ç±»å‹å˜é‡çš„å€¼
mathFunction = multiplyTwoInts
print("ç»“æœ: \(mathFunction(2, 3))")  // è¾“å‡º: ç»“æœ: 6

// ç±»å‹æ¨æ–­
let anotherMathFunction = addTwoInts  // Swiftæ¨æ–­ç±»å‹
print("æ¨æ–­ç±»å‹ç»“æœ: \(anotherMathFunction(5, 7))")  // è¾“å‡º: æ¨æ–­ç±»å‹ç»“æœ: 12
```

### å‡½æ•°ç±»å‹ä½œä¸ºå‚æ•°

```swift
// å‡½æ•°ä½œä¸ºå‚æ•°
func printMathResult(_ mathFunction: (Int, Int) -> Int, _ a: Int, _ b: Int) {
    print("ç»“æœ: \(mathFunction(a, b))")
}

printMathResult(addTwoInts, 3, 5)      // è¾“å‡º: ç»“æœ: 8
printMathResult(multiplyTwoInts, 3, 5)  // è¾“å‡º: ç»“æœ: 15

// æ›´å¤æ‚çš„ä¾‹å­
func calculate(numbers: [Int], operation: (Int, Int) -> Int) -> Int? {
    guard !numbers.isEmpty else { return nil }
    
    var result = numbers[0]
    for i in 1..<numbers.count {
        result = operation(result, numbers[i])
    }
    return result
}

let numbers = [1, 2, 3, 4, 5]
if let sum = calculate(numbers: numbers, operation: addTwoInts) {
    print("æ€»å’Œ: \(sum)")  // è¾“å‡º: æ€»å’Œ: 15
}

if let product = calculate(numbers: numbers, operation: multiplyTwoInts) {
    print("ä¹˜ç§¯: \(product)")  // è¾“å‡º: ä¹˜ç§¯: 120
}
```

### å‡½æ•°ç±»å‹ä½œä¸ºè¿”å›å€¼

```swift
// è¿”å›å‡½æ•°ç±»å‹
func chooseStepFunction(backward: Bool) -> (Int) -> Int {
    func stepForward(input: Int) -> Int { return input + 1 }
    func stepBackward(input: Int) -> Int { return input - 1 }
    return backward ? stepBackward : stepForward
}

var currentValue = 3
let moveNearerToZero = chooseStepFunction(backward: currentValue > 0)

print("è®¡æ•°è‡³é›¶:")
while currentValue != 0 {
    print("\(currentValue)...")
    currentValue = moveNearerToZero(currentValue)
}
print("é›¶!")
// è¾“å‡º:
// è®¡æ•°è‡³é›¶:
// 3...
// 2...
// 1...
// é›¶!
```

## ğŸ§Š é—­åŒ…åŸºç¡€

### é—­åŒ…è¡¨è¾¾å¼è¯­æ³•

```swift
// ä¼ ç»Ÿå‡½æ•°æ’åº
let names = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]

func backward(_ s1: String, _ s2: String) -> Bool {
    return s1 > s2
}

var reversedNames = names.sorted(by: backward)
print("åå‘æ’åº: \(reversedNames)")

// é—­åŒ…è¡¨è¾¾å¼æ’åº
reversedNames = names.sorted(by: { (s1: String, s2: String) -> Bool in
    return s1 > s2
})
print("é—­åŒ…æ’åº: \(reversedNames)")

// å®Œæ•´çš„é—­åŒ…è¯­æ³•
let sortedNames = names.sorted(by: { (s1: String, s2: String) -> Bool in
    return s1 < s2
})
print("å‡åºæ’åº: \(sortedNames)")
```

### é—­åŒ…è¯­æ³•ç®€åŒ–

```swift
let names = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]

// 1. æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹
reversedNames = names.sorted(by: { s1, s2 in return s1 > s2 })

// 2. å•è¡¨è¾¾å¼é—­åŒ…éšå¼è¿”å›
reversedNames = names.sorted(by: { s1, s2 in s1 > s2 })

// 3. å‚æ•°åç§°ç¼©å†™
reversedNames = names.sorted(by: { $0 > $1 })

// 4. è¿ç®—ç¬¦æ–¹æ³•
reversedNames = names.sorted(by: >)

print("æ‰€æœ‰æ–¹å¼ç»“æœç›¸åŒ: \(reversedNames)")
```

### å°¾éšé—­åŒ…

```swift
// æ™®é€šé—­åŒ…è°ƒç”¨
func someFunctionThatTakesAClosure(closure: () -> Void) {
    closure()
}

someFunctionThatTakesAClosure(closure: {
    print("é—­åŒ…è¢«è°ƒç”¨")
})

// å°¾éšé—­åŒ…è¯­æ³•
someFunctionThatTakesAClosure() {
    print("å°¾éšé—­åŒ…è¢«è°ƒç”¨")
}

// å¦‚æœé—­åŒ…æ˜¯å”¯ä¸€å‚æ•°ï¼Œå¯ä»¥çœç•¥æ‹¬å·
someFunctionThatTakesAClosure {
    print("çœç•¥æ‹¬å·çš„å°¾éšé—­åŒ…")
}

// å®é™…åº”ç”¨ï¼šæ•°ç»„æ’åº
let digitNames = [
    0: "Zero", 1: "One", 2: "Two", 3: "Three", 4: "Four",
    5: "Five", 6: "Six", 7: "Seven", 8: "Eight", 9: "Nine"
]

let numbers = [16, 58, 510]

let strings = numbers.map { (number) -> String in
    var number = number
    var output = ""
    repeat {
        output = digitNames[number % 10]! + output
        number /= 10
    } while number > 0
    return output
}

print("æ•°å­—è½¬æ–‡å­—: \(strings)")
// è¾“å‡º: æ•°å­—è½¬æ–‡å­—: ["OneSix", "FiveEight", "FiveOneZero"]
```

## ğŸ”„ é«˜é˜¶å‡½æ•°

### mapå‡½æ•°

```swift
let numbers = [1, 2, 3, 4, 5]

// æ•°å­—å¹³æ–¹
let squaredNumbers = numbers.map { $0 * $0 }
print("å¹³æ–¹: \(squaredNumbers)")  // è¾“å‡º: å¹³æ–¹: [1, 4, 9, 16, 25]

// æ•°å­—è½¬å­—ç¬¦ä¸²
let stringNumbers = numbers.map { "æ•°å­—\($0)" }
print("è½¬å­—ç¬¦ä¸²: \(stringNumbers)")  // è¾“å‡º: è½¬å­—ç¬¦ä¸²: ["æ•°å­—1", "æ•°å­—2", "æ•°å­—3", "æ•°å­—4", "æ•°å­—5"]

// å¤„ç†å¯é€‰ç±»å‹
let possibleNumbers = ["1", "2", "three", "4", "5"]
let mappedNumbers = possibleNumbers.map { Int($0) }
print("å¯é€‰æ•°å­—: \(mappedNumbers)")  // è¾“å‡º: å¯é€‰æ•°å­—: [Optional(1), Optional(2), nil, Optional(4), Optional(5)]

// compactMapå»é™¤nil
let validNumbers = possibleNumbers.compactMap { Int($0) }
print("æœ‰æ•ˆæ•°å­—: \(validNumbers)")  // è¾“å‡º: æœ‰æ•ˆæ•°å­—: [1, 2, 4, 5]
```

### filterå‡½æ•°

```swift
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

// è¿‡æ»¤å¶æ•°
let evenNumbers = numbers.filter { $0 % 2 == 0 }
print("å¶æ•°: \(evenNumbers)")  // è¾“å‡º: å¶æ•°: [2, 4, 6, 8, 10]

// è¿‡æ»¤å¤§äº5çš„æ•°
let bigNumbers = numbers.filter { $0 > 5 }
print("å¤§äº5: \(bigNumbers)")  // è¾“å‡º: å¤§äº5: [6, 7, 8, 9, 10]

// å­—ç¬¦ä¸²è¿‡æ»¤
let words = ["apple", "banana", "cherry", "date"]
let longWords = words.filter { $0.count > 5 }
print("é•¿å•è¯: \(longWords)")  // è¾“å‡º: é•¿å•è¯: ["banana", "cherry"]
```

### reduceå‡½æ•°

```swift
let numbers = [1, 2, 3, 4, 5]

// æ±‚å’Œ
let sum = numbers.reduce(0, +)
print("æ€»å’Œ: \(sum)")  // è¾“å‡º: æ€»å’Œ: 15

// æ±‚ä¹˜ç§¯
let product = numbers.reduce(1, *)
print("ä¹˜ç§¯: \(product)")  // è¾“å‡º: ä¹˜ç§¯: 120

// å­—ç¬¦ä¸²è¿æ¥
let words = ["Hello", "Swift", "World"]
let sentence = words.reduce("") { result, word in
    return result.isEmpty ? word : result + " " + word
}
print("å¥å­: \(sentence)")  // è¾“å‡º: å¥å­: Hello Swift World

// æ›´ç®€æ´çš„å­—ç¬¦ä¸²è¿æ¥
let simpleSentence = words.reduce("") { $0.isEmpty ? $1 : $0 + " " + $1 }
print("ç®€æ´å¥å­: \(simpleSentence)")  // è¾“å‡º: ç®€æ´å¥å­: Hello Swift World
```

### é“¾å¼è°ƒç”¨

```swift
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

// é“¾å¼æ“ä½œï¼šè¿‡æ»¤å¶æ•°ï¼Œå¹³æ–¹ï¼Œæ±‚å’Œ
let result = numbers
    .filter { $0 % 2 == 0 }     // [2, 4, 6, 8, 10]
    .map { $0 * $0 }            // [4, 16, 36, 64, 100]
    .reduce(0, +)               // 220

print("å¶æ•°å¹³æ–¹å’Œ: \(result)")  // è¾“å‡º: å¶æ•°å¹³æ–¹å’Œ: 220

// å¤æ‚çš„æ•°æ®å¤„ç†
struct Student {
    let name: String
    let grade: Int
    let subject: String
}

let students = [
    Student(name: "Alice", grade: 85, subject: "Math"),
    Student(name: "Bob", grade: 92, subject: "Science"),
    Student(name: "Charlie", grade: 78, subject: "Math"),
    Student(name: "Diana", grade: 95, subject: "Science"),
    Student(name: "Eve", grade: 88, subject: "Math")
]

// æ‰¾å‡ºæ•°å­¦æˆç»©ä¼˜ç§€çš„å­¦ç”Ÿå§“å
let excellentMathStudents = students
    .filter { $0.subject == "Math" && $0.grade >= 85 }
    .map { $0.name }
    .sorted()

print("æ•°å­¦ä¼˜ç§€å­¦ç”Ÿ: \(excellentMathStudents)")  // è¾“å‡º: æ•°å­¦ä¼˜ç§€å­¦ç”Ÿ: ["Alice", "Eve"]
```

## ğŸ¯ é€ƒé€¸é—­åŒ…å’Œéé€ƒé€¸é—­åŒ…

### éé€ƒé€¸é—­åŒ…ï¼ˆé»˜è®¤ï¼‰

```swift
// éé€ƒé€¸é—­åŒ… - å‡½æ•°è¿”å›å‰å¿…é¡»è°ƒç”¨
func someFunctionWithNonescapingClosure(closure: () -> Void) {
    print("å‡½æ•°å¼€å§‹")
    closure()  // åœ¨å‡½æ•°è¿”å›å‰è°ƒç”¨
    print("å‡½æ•°ç»“æŸ")
}

someFunctionWithNonescapingClosure {
    print("éé€ƒé€¸é—­åŒ…æ‰§è¡Œ")
}
// è¾“å‡º:
// å‡½æ•°å¼€å§‹
// éé€ƒé€¸é—­åŒ…æ‰§è¡Œ
// å‡½æ•°ç»“æŸ
```

### é€ƒé€¸é—­åŒ…

```swift
// é€ƒé€¸é—­åŒ… - å¯èƒ½åœ¨å‡½æ•°è¿”å›åè°ƒç”¨
var completionHandlers: [() -> Void] = []

func someFunctionWithEscapingClosure(completionHandler: @escaping () -> Void) {
    completionHandlers.append(completionHandler)  // é—­åŒ…é€ƒé€¸äº†
    print("é—­åŒ…å·²å­˜å‚¨ï¼Œå‡½æ•°å³å°†è¿”å›")
}

someFunctionWithEscapingClosure {
    print("é€ƒé€¸é—­åŒ…æ‰§è¡Œ")
}

print("å‡½æ•°å·²è¿”å›ï¼Œç°åœ¨æ‰§è¡Œå­˜å‚¨çš„é—­åŒ…")
completionHandlers.first?()  // åœ¨å‡½æ•°è¿”å›åæ‰§è¡Œ

// è¾“å‡º:
// é—­åŒ…å·²å­˜å‚¨ï¼Œå‡½æ•°å³å°†è¿”å›
// å‡½æ•°å·²è¿”å›ï¼Œç°åœ¨æ‰§è¡Œå­˜å‚¨çš„é—­åŒ…
// é€ƒé€¸é—­åŒ…æ‰§è¡Œ

// å®é™…åº”ç”¨ï¼šå¼‚æ­¥æ“ä½œ
func fetchData(completion: @escaping (String) -> Void) {
    print("å¼€å§‹è·å–æ•°æ®...")
    
    // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
    DispatchQueue.global().asyncAfter(deadline: .now() + 2) {
        completion("æ•°æ®è·å–æˆåŠŸ")
    }
    
    print("å‡½æ•°è¿”å›ï¼Œä½†æ•°æ®ä»åœ¨è·å–ä¸­...")
}

fetchData { data in
    print("æ”¶åˆ°æ•°æ®: \(data)")
}
```

## ğŸ¯ å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šå‡½æ•°å¼è®¡ç®—å™¨

```swift
struct Calculator {
    // åŸºæœ¬è¿ç®—å‡½æ•°
    static func add(_ a: Double, _ b: Double) -> Double { a + b }
    static func subtract(_ a: Double, _ b: Double) -> Double { a - b }
    static func multiply(_ a: Double, _ b: Double) -> Double { a * b }
    static func divide(_ a: Double, _ b: Double) -> Double { b != 0 ? a / b : 0 }
    
    // é«˜é˜¶å‡½æ•°ï¼šæ‰§è¡Œè¿ç®—
    static func calculate(
        numbers: [Double],
        operation: (Double, Double) -> Double
    ) -> Double? {
        guard !numbers.isEmpty else { return nil }
        return numbers.dropFirst().reduce(numbers[0], operation)
    }
    
    // é“¾å¼è®¡ç®—
    static func chainCalculate(
        initial: Double,
        operations: [(Double, (Double, Double) -> Double)]
    ) -> Double {
        return operations.reduce(initial) { result, operation in
            operation.1(result, operation.0)
        }
    }
}

// æµ‹è¯•è®¡ç®—å™¨
let numbers = [10.0, 2.0, 3.0]

if let sum = Calculator.calculate(numbers: numbers, operation: Calculator.add) {
    print("è¿åŠ ç»“æœ: \(sum)")  // è¾“å‡º: è¿åŠ ç»“æœ: 15.0
}

if let product = Calculator.calculate(numbers: numbers, operation: Calculator.multiply) {
    print("è¿ä¹˜ç»“æœ: \(product)")  // è¾“å‡º: è¿ä¹˜ç»“æœ: 60.0
}

// é“¾å¼è®¡ç®—ï¼š10 + 5 * 2 - 3 / 2
let chainResult = Calculator.chainCalculate(
    initial: 10,
    operations: [
        (5, Calculator.add),        // 10 + 5 = 15
        (2, Calculator.multiply),   // 15 * 2 = 30
        (3, Calculator.subtract),   // 30 - 3 = 27
        (2, Calculator.divide)      // 27 / 2 = 13.5
    ]
)
print("é“¾å¼è®¡ç®—ç»“æœ: \(chainResult)")  // è¾“å‡º: é“¾å¼è®¡ç®—ç»“æœ: 13.5
```

### ç»ƒä¹ 2ï¼šæ•°æ®å¤„ç†ç®¡é“

```swift
struct DataProcessor {
    // æ•°æ®æ¸…ç†
    static func cleanData(_ data: [String]) -> [String] {
        return data.filter { !$0.isEmpty }
            .map { $0.trimmingCharacters(in: .whitespacesAndNewlines) }
    }
    
    // æ•°æ®è½¬æ¢
    static func transformToNumbers(_ data: [String]) -> [Int] {
        return data.compactMap { Int($0) }
    }
    
    // æ•°æ®ç»Ÿè®¡
    static func calculateStats(_ numbers: [Int]) -> (count: Int, sum: Int, average: Double) {
        let count = numbers.count
        let sum = numbers.reduce(0, +)
        let average = count > 0 ? Double(sum) / Double(count) : 0
        return (count, sum, average)
    }
    
    // æ•°æ®è¿‡æ»¤å™¨å·¥å‚
    static func createFilter(min: Int, max: Int) -> (Int) -> Bool {
        return { number in
            return number >= min && number <= max
        }
    }
    
    // å®Œæ•´å¤„ç†ç®¡é“
    static func processData(
        rawData: [String],
        filter: ((Int) -> Bool)? = nil
    ) -> (valid: [Int], stats: (count: Int, sum: Int, average: Double)) {
        
        var numbers = rawData
            |> cleanData
            |> transformToNumbers
        
        if let filter = filter {
            numbers = numbers.filter(filter)
        }
        
        let stats = calculateStats(numbers)
        return (numbers, stats)
    }
}

// è‡ªå®šä¹‰è¿ç®—ç¬¦ï¼šç®¡é“æ“ä½œ
infix operator |> : MultiplicationPrecedence

func |><T, U>(value: T, function: (T) -> U) -> U {
    return function(value)
}

// æµ‹è¯•æ•°æ®å¤„ç†
let rawData = [" 10 ", "20", "", "abc", "30", " 40 ", "50", "0", "100"]

print("åŸå§‹æ•°æ®: \(rawData)")

// åŸºæœ¬å¤„ç†
let (allNumbers, allStats) = DataProcessor.processData(rawData: rawData)
print("å¤„ç†åæ•°å­—: \(allNumbers)")
print("ç»Ÿè®¡ä¿¡æ¯: æ•°é‡=\(allStats.count), æ€»å’Œ=\(allStats.sum), å¹³å‡å€¼=\(allStats.average)")

// å¸¦è¿‡æ»¤å™¨å¤„ç†
let rangeFilter = DataProcessor.createFilter(min: 20, max: 50)
let (filteredNumbers, filteredStats) = DataProcessor.processData(
    rawData: rawData,
    filter: rangeFilter
)
print("è¿‡æ»¤åæ•°å­—(20-50): \(filteredNumbers)")
print("è¿‡æ»¤ç»Ÿè®¡: æ•°é‡=\(filteredStats.count), æ€»å’Œ=\(filteredStats.sum), å¹³å‡å€¼=\(filteredStats.average)")
```

### ç»ƒä¹ 3ï¼šå¼‚æ­¥ä»»åŠ¡ç®¡ç†å™¨

```swift
class TaskManager {
    private var tasks: [(String, () -> Void)] = []
    private var completionHandlers: [String: () -> Void] = [:]
    
    // æ·»åŠ ä»»åŠ¡
    func addTask(id: String, task: @escaping () -> Void) {
        tasks.append((id, task))
        print("ä»»åŠ¡ \(id) å·²æ·»åŠ ")
    }
    
    // æ·»åŠ å®Œæˆå›è°ƒ
    func onComplete(taskId: String, handler: @escaping () -> Void) {
        completionHandlers[taskId] = handler
    }
    
    // æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡
    func executeAllTasks() {
        print("å¼€å§‹æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡...")
        
        for (id, task) in tasks {
            print("æ‰§è¡Œä»»åŠ¡: \(id)")
            task()
            
            // è°ƒç”¨å®Œæˆå›è°ƒ
            if let handler = completionHandlers[id] {
                handler()
            }
        }
        
        print("æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•")
        tasks.removeAll()
        completionHandlers.removeAll()
    }
    
    // æ¡ä»¶æ‰§è¡Œ
    func executeIf(condition: () -> Bool, task: @escaping () -> Void) {
        if condition() {
            task()
        } else {
            print("æ¡ä»¶ä¸æ»¡è¶³ï¼Œè·³è¿‡æ‰§è¡Œ")
        }
    }
    
    // é‡è¯•æœºåˆ¶
    func retry(maxAttempts: Int, task: () throws -> Void) {
        var attempts = 0
        
        while attempts < maxAttempts {
            attempts += 1
            do {
                try task()
                print("ä»»åŠ¡åœ¨ç¬¬\(attempts)æ¬¡å°è¯•åæˆåŠŸ")
                return
            } catch {
                print("ç¬¬\(attempts)æ¬¡å°è¯•å¤±è´¥: \(error)")
                if attempts == maxAttempts {
                    print("è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œä»»åŠ¡å¤±è´¥")
                }
            }
        }
    }
}

// ä½¿ç”¨ä»»åŠ¡ç®¡ç†å™¨
let taskManager = TaskManager()

// æ·»åŠ ä»»åŠ¡å’Œå›è°ƒ
taskManager.addTask(id: "task1") {
    print("  æ‰§è¡Œä»»åŠ¡1: æ•°æ®å¤„ç†")
}

taskManager.addTask(id: "task2") {
    print("  æ‰§è¡Œä»»åŠ¡2: æ–‡ä»¶ä¸Šä¼ ")
}

taskManager.addTask(id: "task3") {
    print("  æ‰§è¡Œä»»åŠ¡3: å‘é€é€šçŸ¥")
}

// æ·»åŠ å®Œæˆå›è°ƒ
taskManager.onComplete(taskId: "task1") {
    print("  âœ… ä»»åŠ¡1å®Œæˆå›è°ƒ")
}

taskManager.onComplete(taskId: "task2") {
    print("  âœ… ä»»åŠ¡2å®Œæˆå›è°ƒ")
}

taskManager.onComplete(taskId: "task3") {
    print("  âœ… ä»»åŠ¡3å®Œæˆå›è°ƒ")
}

// æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡
taskManager.executeAllTasks()

// æ¡ä»¶æ‰§è¡Œç¤ºä¾‹
let shouldExecute = true
taskManager.executeIf(condition: { shouldExecute }) {
    print("æ¡ä»¶ä»»åŠ¡è¢«æ‰§è¡Œ")
}

// é‡è¯•æœºåˆ¶ç¤ºä¾‹
enum TaskError: Error {
    case networkError
    case serverError
}

var attemptCount = 0
taskManager.retry(maxAttempts: 3) {
    attemptCount += 1
    if attemptCount < 3 {
        throw TaskError.networkError
    }
    print("ä»»åŠ¡æœ€ç»ˆæˆåŠŸ")
}
```

## ğŸ“ å°ç»“

### é‡ç‚¹å›é¡¾

1. **å‡½æ•°åŸºç¡€**ï¼šå®šä¹‰ã€è°ƒç”¨ã€å‚æ•°ã€è¿”å›å€¼
2. **å‡½æ•°ç±»å‹**ï¼šä½œä¸ºå˜é‡ã€å‚æ•°ã€è¿”å›å€¼ä½¿ç”¨
3. **é—­åŒ…è¡¨è¾¾å¼**ï¼šè‡ªåŒ…å«çš„å‡½æ•°ä»£ç å—
4. **è¯­æ³•ç®€åŒ–**ï¼šç±»å‹æ¨æ–­ã€éšå¼è¿”å›ã€å‚æ•°ç¼©å†™
5. **é«˜é˜¶å‡½æ•°**ï¼šmapã€filterã€reduceç­‰å‡½æ•°å¼ç¼–ç¨‹å·¥å…·
6. **é€ƒé€¸é—­åŒ…**ï¼šå¼‚æ­¥æ“ä½œä¸­çš„é—­åŒ…ä½¿ç”¨

### æœ€ä½³å®è·µ

- ä½¿ç”¨æœ‰æ„ä¹‰çš„å‚æ•°æ ‡ç­¾æé«˜ä»£ç å¯è¯»æ€§
- ä¸ºå‡½æ•°å‚æ•°æä¾›åˆç†çš„é»˜è®¤å€¼
- ä¼˜å…ˆä½¿ç”¨éé€ƒé€¸é—­åŒ…ï¼Œå¿…è¦æ—¶æ‰ä½¿ç”¨@escaping
- å–„ç”¨é«˜é˜¶å‡½æ•°è¿›è¡Œæ•°æ®å¤„ç†
- ä½¿ç”¨å°¾éšé—­åŒ…è¯­æ³•ç®€åŒ–ä»£ç 
- åˆç†ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹æé«˜ä»£ç è´¨é‡

### å¸¸è§é™·é˜±

- å¿˜è®°åœ¨é€ƒé€¸é—­åŒ…ä¸­ä½¿ç”¨@escapingå…³é”®å­—
- è¿‡åº¦ç®€åŒ–é—­åŒ…è¯­æ³•å¯¼è‡´ä»£ç éš¾ä»¥ç†è§£
- åœ¨é—­åŒ…ä¸­å½¢æˆå¾ªç¯å¼•ç”¨
- æ»¥ç”¨å¯å˜å‚æ•°å‡½æ•°
- ä¸å½“ä½¿ç”¨è¾“å…¥è¾“å‡ºå‚æ•°

## ğŸ”„ ä¸‹ä¸€æ­¥

å®Œæˆæœ¬ç« å­¦ä¹ åï¼Œç»§ç»­å­¦ä¹  [05-é”™è¯¯å¤„ç†](./05-é”™è¯¯å¤„ç†.md) ç« èŠ‚ï¼ŒæŒæ¡Swiftä¸­ä¼˜é›…çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚ 